(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{450:function(e,t,a){"use strict";a.r(t);var s=a(0),r=Object(s.a)({},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h1",{attrs:{id:"how-do-i"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#how-do-i"}},[e._v("#")]),e._v(" How Do I")]),e._v(" "),a("h2",{attrs:{id:"what-are-the-recommended-resource-limit-values"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#what-are-the-recommended-resource-limit-values"}},[e._v("#")]),e._v(" What are the recommended resource limit values?")]),e._v(" "),a("p",[e._v('The recommended values don\'t depend on the power of your server. They only depend on how "fast" you want your hosting accounts to be.')]),e._v(" "),a("p",[a("em",[e._v("Typical Hosting Account")]),e._v(":")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("SPEED=100%\nPMEM=512MB\nVMEM=0\nIO=1024KB/s\nIOPS=1024\nNPROC=100\nEP=20\n")])])])]),e._v(" "),a("p",[a("em",[e._v("High End Hosting Account")]),e._v(":")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("SPEED=200%  \nPMEM=1GB  \nVMEM=0  \nIO=4096KB/s  \nIOPS=1024  \nNPROC=100  \nEP=40\n")])])])]),e._v(" "),a("p",[e._v("More information about LVE limits can be found at:\n"),a("a",{attrs:{href:"https://docs.cloudlinux.com/limits/",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://docs.cloudlinux.com/limits/"),a("OutboundLink")],1)]),e._v(" "),a("h2",{attrs:{id:"how-can-i-remove-alt-php-binaries-from-multi-php-manager-in-ea4"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#how-can-i-remove-alt-php-binaries-from-multi-php-manager-in-ea4"}},[e._v("#")]),e._v(" How can I remove Alt-PHP binaries from Multi-PHP Manager in EA4?")]),e._v(" "),a("p",[e._v("You can remove Alt-PHP binaries from cPanel MultiPHP Manager.")]),e._v(" "),a("p",[e._v("To do so set 'yes' or 'no' for the Alt-PHP versions in config file "),a("em",[e._v("/opt/alt/alt-php-config/alt-php.cfg")]),e._v(" and run "),a("strong",[e._v("/opt/alt/alt-php-config/multiphp_reconfigure.py")]),e._v(".")]),e._v(" "),a("p",[e._v("This script manages SCL prefixes for the Alt-PHP - removes or creates prefixes in "),a("em",[e._v("/etc/scl/prefixes")]),e._v(".")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("p",[e._v("/opt/alt/alt-php-config/alt-php.cfg:")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("[MultiPHP Manager]\nalt-php44 = no\nalt-php51 = no\nalt-php52 = no\nalt-php53 = no\nalt-php54 = no\nalt-php55 = yes\nalt-php56 = yes\nalt-php70 = yes\nalt-php71 = yes\nalt-php72 = yes\n")])])])]),e._v(" "),a("h2",{attrs:{id:"adding-cloudlinux-os-image-to-digitalocean"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#adding-cloudlinux-os-image-to-digitalocean"}},[e._v("#")]),e._v(" Adding CloudLinux OS image to DigitalOcean")]),e._v(" "),a("p",[e._v("Custom images are Linux distributions that have been modified to fit the specific needs of DigitalOcean users. In this guide, we will discuss some basics of importing a custom CloudLinux OS image.")]),e._v(" "),a("p",[e._v("Importing custom images to DigitalOcean is free, as you are only charged for the storage of your image. To save money, you can easily import your image, start a Droplet from your image, and delete the image, so you don’t incur any storage costs.")]),e._v(" "),a("p",[e._v("In this article we will describe how to add a qcow2 (QEMU/KVM) CloudLinux OS image as a custom image. You can find more information on image options at "),a("a",{attrs:{href:"https://www.digitalocean.com/docs/images/custom-images/overview/",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://www.digitalocean.com/docs/images/custom-images/overview/"),a("OutboundLink")],1)]),e._v(" "),a("ol",[a("li",[a("p",[e._v("To choose the right image, navigate to "),a("a",{attrs:{href:"https://download.cloudlinux.com/cloudlinux/images/#kvm-tab",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://download.cloudlinux.com/cloudlinux/images/#kvm-tab"),a("OutboundLink")],1),a("br"),e._v("\nSeveral different images are available for download (with and without a control panel).\n"),a("img",{attrs:{src:"/images/unnamed-2.png",alt:"KVM images"}})])]),e._v(" "),a("li",[a("p",[e._v("Copy the link for the image you are going to use and log into "),a("a",{attrs:{href:"https://blog.digitalocean.com/custom-images/cloud.digitalocean.com",target:"_blank",rel:"noopener noreferrer"}},[e._v("cloud.digitalocean.com"),a("OutboundLink")],1),e._v(". Click on ‘Images’ on the left of the screen and then choose “Custom Images”. Click the “Import via URL” button and paste the CloudLinux OS image link.\n"),a("img",{attrs:{src:"/images/unnamed-3.png",alt:"Custom images"}}),a("br"),e._v("\nThere are several options here, but the most important is ‘Choose a datacenter region’, i.e. which datacenter region your Droplets should be created in for this image."),a("br"),e._v(" "),a("img",{attrs:{src:"/images/unnamed-4.png",alt:"Upload"}}),a("br"),e._v(" "),a("img",{attrs:{src:"/images/unnamed-5.png",alt:"Tags"}}),a("br"),e._v("\nClick the “Upload Image” button and wait until the image is successfully uploaded.")])]),e._v(" "),a("li",[a("p",[e._v("Add your public key to access your droplets using key-based authentication: navigate to the ‘Security’ sidebar menu and click the ‘Add SSH Key’ button. You can find more information about creating/adding SSH keys in "),a("a",{attrs:{href:"https://www.digitalocean.com/docs/droplets/how-to/add-ssh-keys/",target:"_blank",rel:"noopener noreferrer"}},[e._v("this article"),a("OutboundLink")],1),e._v("."),a("br"),e._v(" "),a("img",{attrs:{src:"/images/unnamed-6.png",alt:"New SSH Key"}})])]),e._v(" "),a("li",[a("p",[e._v("You will then be able to start a CloudLinux OS Droplet using the image. Note, your Droplet will be created in the same datacenter that your custom image resides in."),a("br"),e._v(" "),a("img",{attrs:{src:"/images/unnamed-7.png",alt:"Start a droplet"}})])]),e._v(" "),a("li",[a("p",[e._v("Now, use your preferred SSH client software to connect to your Droplet. You can find more information on SSH client setup "),a("a",{attrs:{href:"https://www.digitalocean.com/docs/droplets/how-to/connect-with-ssh/",target:"_blank",rel:"noopener noreferrer"}},[e._v("here"),a("OutboundLink")],1),e._v("."),a("br"),e._v(" "),a("img",{attrs:{src:"/images/unnamed-8.png",alt:"SSH Client"}})])])]),e._v(" "),a("h2",{attrs:{id:"how-can-i-switch-cloudlinux-usage-statistics-off"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#how-can-i-switch-cloudlinux-usage-statistics-off"}},[e._v("#")]),e._v(" How can I switch CloudLinux usage statistics off?")]),e._v(" "),a("p",[e._v("Starting with lve-utils 3.0-21.12 Beta, it is possible to permanently disable statistics gathering by adding "),a("code",[e._v("cl_statistics_enabled=0")]),e._v(" parameter to "),a("em",[e._v("/etc/sysconfig/cloudlinux")]),e._v(".")]),e._v(" "),a("h2",{attrs:{id:"pear-installation"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#pear-installation"}},[e._v("#")]),e._v(" PEAR installation")]),e._v(" "),a("p",[e._v("If you wish to install Pear for cPanel PHP (native PHP version) for some user, then you can use the standard way provided by WHM/cPanel, but if the alt-PHP (PHP Selector) is used, then you (as root or as an user) need to install necessary Pear modules by using pear for current user php like this:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("# /opt/alt/phpXX/usr/bin/pear install moduleName\n")])])])]),e._v(" "),a("p",[e._v("where "),a("strong",[e._v("XX")]),e._v(" is PHP version (for example 71 for PHP 7.1).\nIn this case "),a("code",[e._v("include_path")]),e._v(" will contain the value "),a("em",[e._v('"/opt/alt/php71/usr/share/pear"')])]),e._v(" "),a("p",[e._v("Alternatively, you can set it manually in "),a("em",[e._v("/opt/alt/php71/etc/php.ini")]),e._v(" directly (for PHP 7.1 as an example):")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('include_path = ".:/usr/share/pear:/opt/alt/php71/usr/share/php:/opt/alt/php71/usr/share/pear"\n')])])])]),e._v(" "),a("h2",{attrs:{id:"newrelic-configuration-and-troubleshooting-steps"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#newrelic-configuration-and-troubleshooting-steps"}},[e._v("#")]),e._v(" NewRelic configuration and troubleshooting steps")]),e._v(" "),a("p",[e._v("In case you want to configure NewRelic extension but get the errors like these")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("[Wed Mar 15 14:56:43.240939 2017] [cgi:error] [pid 566485] [client 5.44.233.42:44548] AH01215: PHP Warning: PHP Startup: Unable to load dynamic library '/opt/alt/php70/usr/lib64/php/modules/newrelic-20160303.so' - /opt/alt/php70/usr/lib64/php/modules/newrelic-20160303.so: cannot open shared object file: No such file or directory in Unknown on line 0: /usr/local/cpanel/cgi-sys/ea-php56\n[Wed Mar 15 14:56:43.510520 2017] [cgi:error] [pid 566609] [client 52.21.231.226:59007] AH01215: PHP Warning: PHP Startup: Unable to load dynamic library '/opt/alt/php70/usr/lib64/php/modules/newrelic-20160303.so' - /opt/alt/php70/usr/lib64/php/modules/newrelic-20160303.so: cannot open shared object file: No such file or directory in Unknown on line 0: /usr/local/cpanel/cgi-sys/ea-php56\n[Wed Mar 15 14:56:44.771648 2017] [cgi:error] [pid 566368] [client 45.33.61.252:64742] AH01215: PHP Warning: PHP Startup: Unable to load dynamic library '/opt/alt/php70/usr/lib64/php/modules/newrelic-20160303.so' - /opt/alt/php70/usr/lib64/php/modules/newrelic-20160303.so: cannot open shared object file: No such file or directory in Unknown on line 0: /usr/local/cpanel/cgi-sys/ea-php56\n")])])])]),e._v(" "),a("p",[e._v("Please, make sure that Zend Extension Build and NewRelic PHP Extension Build are similar ( should be similar)\nZend Extension Build    API320151012,NTS\nPHP Extension Build    API20151012,NTS")]),e._v(" "),a("p",[e._v("configuration steps:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('# ln -s /usr/lib/newrelic-php5/agent/x64/newrelic-20151012.so /opt/alt/php56/usr/lib64/php/modules/newrelic-20151012.so\n# echo "extension=newrelic-20151012.so" > /opt/alt/php56/etc/php.d.all/newrelic.ini\n# cagefsctl --setup-cl-selector\n# selectorctl -e newrelic -u myuser -v 5.6\n')])])])]),e._v(" "),a("p",[a("em",[e._v("/usr/lib/newrelic-php5/agent/x64/")]),e._v(" -  this is directory with different newrelic agents php"),a("br"),e._v("\nWe need to choose the version that we need regarding zend version"),a("br"),e._v("\nThe /usr/lib/newrelic-php5/ is uncompressed tar from "),a("a",{attrs:{href:"https://download.newrelic.com/php_agent/release/newrelic-php5-7.0.0.186-linux.tar.gz",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://download.newrelic.com/php_agent/release/newrelic-php5-7.0.0.186-linux.tar.gz"),a("OutboundLink")],1)]),e._v(" "),a("h2",{attrs:{id:"how-to-add-xvfb-wkhtmltopdf-to-the-cagefs"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#how-to-add-xvfb-wkhtmltopdf-to-the-cagefs"}},[e._v("#")]),e._v(" How to add xvfb, wkhtmltopdf to the CageFS?")]),e._v(" "),a("p",[e._v("The steps are:")]),e._v(" "),a("ol",[a("li",[e._v("Create "),a("em",[e._v("/etc/cagefs/conf.d/xvfb.cfg")]),e._v(" and add:")])]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("[xvfb]\ncomment=xvfb\npaths=/usr/bin/xvfb-run, /usr/bin/xauth, /usr/bin/Xvfb, /usr/bin/xkbcomp, /usr/bin/wkhtmltopdf, /usr/share/X11/xkb\n")])])])]),e._v(" "),a("ol",{attrs:{start:"2"}},[a("li",[e._v("Run:")])]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("cagefsctl --addrpm xkeyboard-config\n")])])])]),e._v(" "),a("h2",{attrs:{id:"php-composer-installation-howto"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#php-composer-installation-howto"}},[e._v("#")]),e._v(" PHP composer installation howto")]),e._v(" "),a("ol",[a("li",[e._v("Download installer:")])]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("/opt/alt/php55/usr/bin/php -d extension=json.so -d extension=phar.so -r \"readfile('https://getcomposer.org/installer');\" > composer-setup.php\n")])])])]),e._v(" "),a("ol",{attrs:{start:"2"}},[a("li",[e._v("Install composer itself:")])]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("php composer-setup.php --install-dir=/usr/local/bin/ --filename=composer\n")])])])]),e._v(" "),a("ol",{attrs:{start:"3"}},[a("li",[e._v("Generate cagefs config file to make it available for users:")])]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('echo -e "[composer]\\ncomment=PHP Composer\\npaths=/usr/local/bin/composer" > /etc/cagefs/conf.d/php-composer.cfg\n')])])])]),e._v(" "),a("ol",{attrs:{start:"4"}},[a("li",[e._v("Update cagefs:")])]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("/usr/sbin/cagefsctl --force-update\n")])])])]),e._v(" "),a("ol",{attrs:{start:"5"}},[a("li",[a("p",[e._v("For the desired user enable JSON and PHAR with PHP-Selector as required for Composer.")])]),e._v(" "),a("li",[a("p",[e._v("To make composer work with suhosin, the following change is needed for "),a("em",[e._v("/opt/alt/phpXX/etc/php.d.all/suhosin.ini")]),a("br"),e._v("\n(php70 example follows):")])])]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('$ echo "suhosin.executor.include.whitelist = phar" >> /opt/alt/php70/etc/php.d.all/suhosin.ini\n$ cagefsctl --rebuild-alt-php-ini\n')])])])]),e._v(" "),a("h2",{attrs:{id:"fix-http-error-404-not-found-errors-in-yum"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#fix-http-error-404-not-found-errors-in-yum"}},[e._v("#")]),e._v(" Fix HTTP Error 404 - Not Found errors in yum")]),e._v(" "),a("p",[e._v("If you cannot install or update software via yum and you see 404 errors like this:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("http://repo.cloudlinux.com/kernelcare/7.4/x86_64/repodata/repomd.xml: [Errno 14] HTTP Error 404 - Not Found\nhttp://repo.cloudlinux.com/other/cl7.3/mysqlmeta/cl-mariadb-10.1/x86_64/repodata/repomd.xml: [Errno 14] HTTP Error 404 - Not Found\n")])])])]),e._v(" "),a("p",[e._v("Please comment out the following line in "),a("em",[e._v("/etc/yum.conf")]),e._v(":")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("distroverpkg=cloudlinux-release\n")])])])]),e._v(" "),a("p",[e._v("You can run this command to comment out that line automatically:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("sed -r -i 's/^\\s*(distroverpkg\\s*=\\s*cloudlinux-release)/#\\1/g' /etc/yum.conf\n")])])])]),e._v(" "),a("h2",{attrs:{id:"how-to-migrate-all-cloudlinux-os-settings-to-another-server"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#how-to-migrate-all-cloudlinux-os-settings-to-another-server"}},[e._v("#")]),e._v(" How to migrate all CloudLinux OS settings to another server?")]),e._v(" "),a("p",[e._v("To move LVE and packages limits, just move the "),a("em",[e._v("/etc/container/ve.cfg")]),e._v(" file to a new server, and then run")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("# lvectl apply all\n")])])])]),e._v(" "),a("p",[e._v("If any modifications were made to CageFS - move the "),a("em",[e._v("/etc/cagefs/cagefs.mp")]),e._v(" file, and/or "),a("em",[e._v("/etc/cagefs/conf.d")]),e._v(" directory to a new server and run")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("# cagefsctl --force-update && cagefsctl--remount-all\n")])])])]),e._v(" "),a("p",[e._v("For PHP-Selector - move the "),a("em",[e._v("/etc/cl.selector")]),e._v(" directory and run:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("# cagefsctl --setup-cl-selector\n")])])])]),e._v(" "),a("p",[e._v("To restore user's settings from PHP Selector, please refer to the "),a("router-link",{attrs:{to:"/kb/HowDoI/#how-to-restore-php-selector-options-after-restore-or-migration"}},[e._v("following")]),e._v(" KnowledgeBase entry.")],1),e._v(" "),a("p",[e._v("Basically, the custom PHP settings migration plan is:")]),e._v(" "),a("ol",[a("li",[e._v("restore user home dirs")]),e._v(" "),a("li",[e._v("remove all cagefs\\selector directories with")])]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("# rm -rf /var/cagefs/*/*/etc/cl.selector\n# rm -rf /var/cagefs/*/*/etc/cl.php.d\n")])])])]),e._v(" "),a("ol",{attrs:{start:"3"}},[a("li",[e._v("regenerate them with")])]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("# cagefsctl --force-update-etc\n")])])])]),e._v(" "),a("h2",{attrs:{id:"how-to-restore-php-selector-options-after-restore-or-migration"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#how-to-restore-php-selector-options-after-restore-or-migration"}},[e._v("#")]),e._v(" How to restore PHP Selector options after restore or migration?")]),e._v(" "),a("p",[e._v("For restoring PHP Selector options and alternate PHP version from the backup ("),a("strong",[e._v("cltest3")]),e._v(" is an example user user) do the following:")]),e._v(" "),a("ol",[a("li",[e._v("Restore "),a("em",[e._v("~cltest3/.cl.selector/")]),e._v(" directory.")]),e._v(" "),a("li",[e._v("Remove PHP Selector current files from CageFS directory. First, take CageFS prefix:")])]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("$ /usr/sbin/cagefsctl --getprefix cltest3\n")])])])]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("04\n")])])]),a("p",[e._v("Then remove "),a("em",[e._v("cl.selector")]),e._v(" and "),a("em",[e._v("cl.php.d")]),e._v(" in user's "),a("em",[e._v("etc")]),e._v(" directory:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("$ rm -rf /var/cagefs/04/cltest3/etc/cl.selector\n$ rm -rf /var/cagefs/04/cltest3/etc/cl.php.d\n")])])])]),e._v(" "),a("p",[e._v("Run the command to recreate configs:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("$ /usr/sbin/cagefsctl --force-update-etc cltest3\n")])])])]),e._v(" "),a("h2",{attrs:{id:"how-to-check-email-pipe-issue"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#how-to-check-email-pipe-issue"}},[e._v("#")]),e._v(" How to check email pipe issue?")]),e._v(" "),a("p",[e._v("The email piping is a technique of sending an email message as an input to a program rather than appending the message to the mailbox file, allowing for real-time email delivery and handling. Every mail server has its own rules and procedures for mail delivery, making it hard to provide common instructions for configuring an MTA.\nIn this article, we will discuss common email pipe issues on cPanel and Exim as MTA.")]),e._v(" "),a("p",[a("strong",[e._v("Creating a script")])]),e._v(" "),a("p",[e._v("While creating a script, in the very first line we have to specify what should be used to interpret it (the shebang line). Suitable values may be:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("#!/usr/bin/php -q\n#!/usr/local/bin/php -q\n")])])])]),e._v(" "),a("p",[e._v("If you are using CageFS+PHP Selector, "),a("em",[e._v("/usr/bin/php")]),e._v(" and "),a("em",[e._v("/usr/local/bin/php")]),e._v(" are used for CGI/CLI binary versions appropriately.")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("# cat /etc/cl.selector/native.conf \nphp=/usr/bin/php\nphp-cli=/usr/local/bin/php\nphp.ini=/usr/local/lib/php.ini\nphp-fpm=/usr/local/sbin/php-fpm\n")])])])]),e._v(" "),a("p",[e._v("Note the '-q' parameter. This suppresses header output as sometimes php just has to output something. If anything is output by php, the sender will receive a bounceback message containing, among other things, whatever php chose to output. We don't really want this.")]),e._v(" "),a("p",[a("strong",[e._v("Setting up the correct permissions")])]),e._v(" "),a("p",[e._v("For mail to be piped to scripts, both the script and the directory it is in should have permissions of 0755.")]),e._v(" "),a("p",[a("strong",[e._v("Settings up email piping")])]),e._v(" "),a("p",[e._v('Use the "Pipe to a Program" option to pipe email information to your script:'),a("br"),e._v(" "),a("em",[e._v('cpanel user > Forwarders > Add Forwarder button > Advanced Options > choose "Pipe to a Program"')]),a("br"),e._v('\nWhen you use the "Pipe to a Program" option, enter a path that is relative to your home directory. For example, to use the '),a("em",[e._v("/home/user/script.php")]),e._v(" script,\nenter "),a("em",[e._v("script.php")]),e._v(' in the "Pipe to a Program" text box, where user represents your username.')]),e._v(" "),a("p",[e._v("After that, this user will have the following entry in "),a("em",[e._v("/etc/valiases/domain.com")]),e._v(" file:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("# cat /etc/valiases/domain.com \ntest@domain.com: |/home/user/script.php\n")])])])]),e._v(" "),a("p",[e._v("where "),a("em",[e._v("domain.com")]),e._v(" represents your domain name.")]),e._v(" "),a("p",[a("strong",[e._v("Troubleshooting")])]),e._v(" "),a("p",[e._v("If you've written your script correctly, set the permissions on it and it's directory fine and created your email filter correctly everything will work.")]),e._v(" "),a("p",[e._v("If in doubt, quickly check that all of the following are correct:")]),e._v(" "),a("ol",[a("li",[e._v("You have the correct shebang line")]),e._v(" "),a("li",[e._v("Your script reads data from STDIN")]),e._v(" "),a("li",[e._v("Your script has permissions of 0755")]),e._v(" "),a("li",[e._v("The directory in which your script lives has permissions of 0755")]),e._v(" "),a("li",[e._v("Your Forwarder is set up properly. Double check that the path to your script is correct.")]),e._v(" "),a("li",[e._v("You have no extraneous carriage returns")])]),e._v(" "),a("p",[e._v("Below is a simple php script, which can be used to test email piping:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('#!/usr/local/bin/php -q\n<?php\n/* Read the message from STDIN */\n$fd = fopen("php://stdin", "r");\n$email = ""; // This will be the variable holding the data.\nwhile (!feof($fd)) {\n$email .= fread($fd, 1024);\n}\nfclose($fd);\n/* Saves the data into a file */\n$fdw = fopen("/tmp/pipemail.txt", "w+");\nfwrite($fdw, $email);\nfclose($fdw);\n/* Script End */\n?>\n')])])])]),e._v(" "),a("p",[e._v("In order to setup this script, do the following:")]),e._v(" "),a("ol",[a("li",[a("p",[e._v("Create php script with the content provided above inside user's home directory. For example:\n"),a("em",[e._v("/home/user/test.php")])])]),e._v(" "),a("li",[a("p",[e._v("Make it executable:")])])]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("# chmod 755 /home/user/test.php\n")])])])]),e._v(" "),a("ol",{attrs:{start:"3"}},[a("li",[a("p",[e._v("Edit "),a("em",[e._v("/etc/valiases/domain.com")]),e._v(" file:"),a("br"),e._v(" "),a("code",[e._v("test@domain.com: |/home/user/test.php")])])]),e._v(" "),a("li",[a("p",[e._v("Tail exim_mainlog:")])])]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("# tail -f /var/log/exim_mainlog\n")])])])]),e._v(" "),a("ol",{attrs:{start:"5"}},[a("li",[a("p",[e._v("Sent an email to test@domain.com and check Exim log.")])]),e._v(" "),a("li",[a("p",[e._v("Check "),a("em",[e._v("/home/user/.cagefs/tmp/pipemail.txt")]),e._v(" file. If pipemail.txt has email content, then email piping works properly.\nIf pipemail.txt is empty or you still have issues, please submit a "),a("a",{attrs:{href:"https://cloudlinux.zendesk.com/hc/requests/new",target:"_blank",rel:"noopener noreferrer"}},[e._v("ticket"),a("OutboundLink")],1),e._v(".")])])]),e._v(" "),a("h2",{attrs:{id:"configure-cloudlinux-os-features-php-and-mod-lsapi-on-a-server-with-no-control-panel"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#configure-cloudlinux-os-features-php-and-mod-lsapi-on-a-server-with-no-control-panel"}},[e._v("#")]),e._v(" Configure CloudLinux OS features, PHP and mod_lsapi on a server with no control panel")]),e._v(" "),a("p",[e._v("This is a practical manual of setting up Apache + mod_lsapi + CageFS + PHP Selector on a server with no panel installed.")]),e._v(" "),a("p",[e._v("It is assumed that our system has been converted and loaded with CloudLinux kernel. Since PHP Selector installation requires "),a("router-link",{attrs:{to:"/cloudlinux_os_components/#cagefs/"}},[e._v("CageFS")]),e._v(" and "),a("router-link",{attrs:{to:"/lve_manager/"}},[e._v("LVE Manager")]),e._v(" installed in the system, let's start with CageFS installation:")],1),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("# yum install cagefs\n")])])])]),e._v(" "),a("p",[e._v("Next we'll need to install LVE Manager:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("# yum install lvemanager\n")])])])]),e._v(" "),a("p",[e._v("Then install Apache and native PHP:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("# yum install httpd\n# yum install php-cli\n")])])])]),e._v(" "),a("p",[e._v("Then install mod_lsapi:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("# yum install liblsapi liblsapi-devel\n# yum install mod_lsapi\n")])])])]),e._v(" "),a("p",[e._v("Finally, install PHP Selector:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("# yum groupinstall alt-php\n")])])])]),e._v(" "),a("p",[e._v("Now let's configure components. Initialize CageFS and enable for all users:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("# cagefsctl --init\n# cagefsctl --enable-all\n")])])])]),e._v(" "),a("p",[e._v("Initialize mod_lsapi (few errors will appear, this is normal, please ignore them):")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("# /usr/bin/switch_mod_lsapi --setup\n")])])])]),e._v(" "),a("p",[e._v("Enable mod_lsapi PHP handler:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("# sed -i 's/#AddType/AddType/' /etc/httpd/conf.d/lsapi.conf\n")])])])]),e._v(" "),a("p",[e._v("Update CageFS skeleton:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("# cagefsctl --force-update\n")])])])]),e._v(" "),a("p",[e._v("We also need to open access to 80 port:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("# firewall-cmd --zone=public --permanent --add-port=80/tcp\n# firewall-cmd --reload\n")])])])]),e._v(" "),a("p",[e._v("Now we are ready to set up a website. Let's create user first:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("# adduser cltest1\n")])])])]),e._v(" "),a("p",[e._v("Change home directory permissions to allow httpd access it:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("# chmod 711 /home/cltest1\n")])])])]),e._v(" "),a("p",[e._v("Create required directories:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('# su cltest1 -c "mkdir ~/public_html{,/logs,/cgi-bin}"\n')])])])]),e._v(" "),a("p",[e._v("Finally, let's add website to Apache configuration. Create a file "),a("em",[e._v("/etc/httpd/conf.d/vhosts.conf")]),e._v(" with the following contents:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('<VirtualHost *:80>\n  ServerName default\n  DocumentRoot /var/www/html\n</VirtualHost>\n<VirtualHost *:80>\n  ServerAdmin cltest1@example.com\n  DocumentRoot "/home/cltest1/public_html"\n  ServerName example.com\n  ServerAlias www.example.com\n  ErrorLog "/home/cltest1/public_html/logs/error.log"\n  CustomLog "/home/cltest1/public_html/logs/access.log" common\n  ScriptAlias /cgi-bin/ "/home/cltest1/public_html/cgi-bin/"\n  SuexecUserGroup cltest1 cltest1\n  <Directory "/home/cltest1">\n    AllowOverride All\n  </Directory>\n  <Directory "/home/cltest1/public_html/cgi-bin">\n    AllowOverride None\n    Options None\n  </Directory>\n</VirtualHost>\n')])])])]),e._v(" "),a("p",[e._v("Please note, first VirtualHost must be defined only once, it will be used for requests that didn't match any other VirtualHost.")]),e._v(" "),a("p",[e._v("Everything is ready now. Restart Apache httpd:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("# systemctl restart httpd.service\n")])])])]),e._v(" "),a("p",[e._v("You can now use "),a("router-link",{attrs:{to:"/command-line_tools/#selectorctl"}},[e._v("selectorctl")]),e._v(" utility to select PHP versions for your users.")],1),e._v(" "),a("h2",{attrs:{id:"fix-rpmdb-thread-died-in-berkeley-db-library"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#fix-rpmdb-thread-died-in-berkeley-db-library"}},[e._v("#")]),e._v(" Fix rpmdb: Thread died in Berkeley DB library")]),e._v(" "),a("p",[e._v("If you see rpmdb errors during package management (during yum/rpm operations), like this:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("rpmdb: Thread/process 277623/140429100390144 failed: Thread died in Berkeley DB library\nerror: db3 error(-30974) from dbenv->failchk: DB_RUNRECOVERY: Fatal error, run database recovery\nerror: cannot open Packages index using db3 -  (-30974)\nerror: cannot open Packages database in /var/lib/rpm\nCRITICAL:yum.verbose.cli.yumcompletets:Yum Error: Error: rpmdb open failed\n")])])])]),e._v(" "),a("p",[e._v("It means that the RPM database is corrupted.")]),e._v(" "),a("p",[a("strong",[e._v("A similar error can be triggered in LVE Manager Installation Wizard:")])]),e._v(" "),a("p",[a("img",{attrs:{src:"/images/image001.png",alt:"DB broken"}})]),e._v(" "),a("p",[a("strong",[e._v("Solution:")])]),e._v(" "),a("p",[e._v("Please follow these steps to backup and rebuild rpmdb database:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("# mkdir /var/lib/rpm/backup\n# cp -a /var/lib/rpm/__db* /var/lib/rpm/backup/\n# rm -f /var/lib/rpm/__db.[0-9][0-9]*\n# rpm --quiet -qa\n# rpm --rebuilddb\n# yum clean all\n")])])])]),e._v(" "),a("h2",{attrs:{id:"how-to-move-the-mysql-data-folder"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#how-to-move-the-mysql-data-folder"}},[e._v("#")]),e._v(" How to move the mysql data folder")]),e._v(" "),a("ol",[a("li",[e._v("Make a full mysqldump file")])]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("# mysqldump --opt -uroot -proot_password > /tmp/mysqldump\n")])])])]),e._v(" "),a("ol",{attrs:{start:"2"}},[a("li",[e._v("Disable Mysql monitoring")])]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("whmapi1 configureservice service=mysql enabled=1 monitored=0\n")])])])]),e._v(" "),a("ol",{attrs:{start:"3"}},[a("li",[e._v("Stop MySQL")])]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("# systemctl stop mysql\n")])])])]),e._v(" "),a("ol",{attrs:{start:"4"}},[a("li",[e._v("Ensure that the following settings are present")])]),e._v(" "),a("p",[e._v("check file "),a("em",[e._v("/etc/systemd/system/mariadb.service.d/homedir.conf")])]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("[Service]\nProtectHome=false\nProtectSystem=off\n")])])])]),e._v(" "),a("ol",{attrs:{start:"5"}},[a("li",[e._v("Make the directory for MySQL in /home, move it and symlink it:")])]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("# mkdir /home/var_mysql\n# mv /var/lib/mysql /home/var_mysql\n# chown -R mysql:mysql /home/var_mysql/mysql\n# ln -s /home/var_mysql/mysql /var/lib/mysql\n")])])])]),e._v(" "),a("ol",{attrs:{start:"6"}},[a("li",[e._v("Remount CageFS system-wide:")])]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("# cagefsctl --remount-all\n")])])])]),e._v(" "),a("ol",{attrs:{start:"7"}},[a("li",[e._v("Start MySQL:")])]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("# systemctl start mysql\n")])])])]),e._v(" "),a("ol",{attrs:{start:"8"}},[a("li",[e._v("Enable Mysq monitoring")])]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("whmapi1 configureservice service=mysql enabled=1 monitored=1\n")])])])]),e._v(" "),a("h2",{attrs:{id:"how-to-obtain-activation-keys-register-and-migrate-servers"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#how-to-obtain-activation-keys-register-and-migrate-servers"}},[e._v("#")]),e._v(" How to obtain activation keys, register and migrate servers?")]),e._v(" "),a("p",[e._v("There are two ways to get started with CloudLinux OS. You can either convert your existing system or install CloudLinux on a new server. In either case, you will need the activation key.")]),e._v(" "),a("p",[e._v("If you purchased CloudLinux OS through one of our partners, they will provide you with an IP-based license directly.")]),e._v(" "),a("p",[a("strong",[e._v("Getting the activation key")])]),e._v(" "),a("p",[e._v("You can start by using a 30-day free trial key, which can be obtained through the CloudLinux Network (our self-service web portal), also called CLN.\nNew CloudLinux OS activation key can be created through CLN as described "),a("a",{attrs:{href:"https://docs.cln.cloudlinux.com/index.html?cloudlinux_os_activation_keys.htm",target:"_blank",rel:"noopener noreferrer"}},[e._v("here"),a("OutboundLink")],1),e._v(".")]),e._v(" "),a("p",[e._v("Note, you cannot use a new trial key on a system that is already using a trial key.\nOtherwise, you will receive the following error message:")]),e._v(" "),a("p",[a("code",[e._v("The IP <ip-address> was already used for trialing on <registation date>")])]),e._v(" "),a("p",[e._v("This error message is valid for CloudLinux OS and KernelCare.")]),e._v(" "),a("p",[a("strong",[e._v("Migrating licenses and servers")])]),e._v(" "),a("p",[e._v("When you migrate from the trial activation key to a paid one, you have to re-register your installation from the command line interface (server console - run it as root):")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("# rhnreg_ks --activationkey=<newkey> --force\n")])])])]),e._v(" "),a("p",[e._v("For IP-based licenses you may have received from CloudLinux partners, the syntax is different:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("# clnreg_ks --force\n")])])])]),e._v(" "),a("p",[e._v('If you need to reinstall your server, migrate to new hardware or perform any kind of license migration, login to CLN, remove old server(s) in the "Servers" section. After that, you will be able to register a new server with the same activation key. More information about server management can be found '),a("a",{attrs:{href:"https://docs.cln.cloudlinux.com/index.html?servers.htm",target:"_blank",rel:"noopener noreferrer"}},[e._v("here"),a("OutboundLink")],1),e._v(".")]),e._v(" "),a("p",[e._v("If you want to migrate key-based licenses provided by Plesk (starts with 7003*), please open a new support "),a("a",{attrs:{href:"https://cloudlinux.zendesk.com/hc/requests/new",target:"_blank",rel:"noopener noreferrer"}},[e._v("ticket"),a("OutboundLink")],1),e._v(".")]),e._v(" "),a("p",[e._v("Don't worry - the server removal will not affect your customer's websites' operation. Only software update (yum update) and the LVE Manager plugin will become inactive. All the other CloudLinux OS features will continue to work properly.")]),e._v(" "),a("p",[e._v("After removing the servers you no longer need, click on Licenses and pick an activation key with free license slots. Use that key to register your new CloudLinux server from CLI in two simple steps:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("# yum install rhn-setup --enablerepo=cloudlinux-base\n# rhnreg_ks --activationkey=<newkey> --force\n")])])])]),e._v(" "),a("p",[e._v("for IP-based licenses:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("# clnreg_ks --force\n")])])])]),e._v(" "),a("p",[e._v("In case of server migration, you don’t need another activation key to proceed. First, remove the old server from CLN, activate the new server with the same activation key and proceed with the migration.")]),e._v(" "),a("p",[e._v("Otherwise, you will receive the following error message:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("Error Message: \nMaximum usage count of X reached \nError Class Code: 61 \nError Class Info: Too many systems registered using this registration token \nExplanation: \nAn error has occurred while processing your request. If this problem \npersists please enter a bug report at helpdesk.cloudlinux.com. \nIf you choose to submit the bug report, please be sure to include \ndetails of what you were trying to do when this error occurred and \ndetails on how to reproduce this problem.\n\nSee /var/log/up2date for more information\n")])])])]),e._v(" "),a("p",[e._v("In case something went wrong or you need our assistance, please contact our "),a("a",{attrs:{href:"https://cloudlinux.zendesk.com/hc/requests/new",target:"_blank",rel:"noopener noreferrer"}},[e._v("support"),a("OutboundLink")],1),e._v(".")]),e._v(" "),a("h2",{attrs:{id:"how-do-i-fix-duplicated-packages-issue"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#how-do-i-fix-duplicated-packages-issue"}},[e._v("#")]),e._v(" How do I fix duplicated packages issue?")]),e._v(" "),a("p",[e._v("Sometimes after incorrect updates duplicated packages appear in the system, for example:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("<...>\nalt-python27-2.7.13-3.el6.x86_64 is a duplicate with alt-python27-2.7.11-7.el6.x86_64\nalt-python27-2.7.13-4.el6.x86_64 is a duplicate with alt-python27-2.7.13-3.el6.x86_64\nalt-python27-libs-2.7.13-3.el6.x86_64 is a duplicate with alt-python27-libs-2.7.11-7.el6.x86_64\nalt-python27-libs-2.7.13-4.el6.x86_64 is a duplicate with alt-python27-libs-2.7.13-3.el6.x86_64\n<...>\n")])])])]),e._v(" "),a("p",[e._v("First of all, we need the full list of dupes:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("package-cleanup --dupes | tail -n +3\n")])])])]),e._v(" "),a("p",[e._v("We'll also need to save this list into a file:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("package-cleanup --dupes | tail -n +3 > duplist.txt\n")])])])]),e._v(" "),a("p",[a("strong",[e._v("The main idea is to do the following (for each package)")]),e._v(":")]),e._v(" "),a("ol",[a("li",[e._v("Remove the lowest version from the rpmdb: "),a("code",[e._v("rpm -e --justdb --nodeps $PKGNAME")])]),e._v(" "),a("li",[e._v("Reinstall the highest version: "),a("code",[e._v("yum -y reinstall $PKGNAME")])])]),e._v(" "),a("p",[e._v("It is a good idea to check what is going to be done before real operations:")]),e._v(" "),a("p",[e._v("(This will only display a list of all the commands without execution)")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('cat duplist.txt | sort --version-sort | awk \'NR % 2 {print "rpm -e --justdb --nodeps " $1 } !(NR % 2) {match($0, "-[0-9]");print "yum -y reinstall " substr($0,0,RSTART-1)}\'\n')])])])]),e._v(" "),a("p",[e._v("Then we perform the necessary operations:")]),e._v(" "),a("p",[e._v('("pipe sh" has been added at the end in order to execute the sequence):')]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('cat duplist.txt | sort --version-sort | awk \'NR % 2 {print "rpm -e --justdb --nodeps " $1 } !(NR % 2) {match($0, "-[0-9]");print "yum -y reinstall " substr($0,0,RSTART-1)}\' | sh\n')])])])]),e._v(" "),a("p",[e._v("Alternatively, all this could be performed without an intermediary file:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('package-cleanup --dupes | tail -n +3 | sort --version-sort | awk \'NR % 2 {print "rpm -e --justdb --nodeps " $1 } !(NR % 2) {match($0, "-[0-9]");print "yum -y reinstall " substr($0,0,RSTART-1)}\' | sh\n')])])])]),e._v(" "),a("h2",{attrs:{id:"how-to-obtain-vmcore-on-xen-kvm-virtual-machines-with-virsh"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#how-to-obtain-vmcore-on-xen-kvm-virtual-machines-with-virsh"}},[e._v("#")]),e._v(" How To Obtain Vmcore on Xen/KVM Virtual Machines with Virsh?")]),e._v(" "),a("ol",[a("li",[e._v("Make sure you have libvirt tools installed on your KVM host (dom0 for Xen):")])]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("yum install libvirt -y\n")])])])]),e._v(" "),a("ol",{attrs:{start:"2"}},[a("li",[e._v("Make sure virsh utility is installed:")])]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("virsh --version\n2.0.0\n")])])])]),e._v(" "),a("ol",{attrs:{start:"3"}},[a("li",[a("p",[e._v("Login to the Guest OS.")])]),e._v(" "),a("li",[a("p",[e._v("Let the VM wait before rebooting on kernel panic:")])])]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("sysctl kernel.panic=10000 (number of seconds to wait)\n")])])])]),e._v(" "),a("ol",{attrs:{start:"5"}},[a("li",[a("p",[e._v("Wait until the Guest OS is crashed.")])]),e._v(" "),a("li",[a("p",[e._v("Gather VM dump with virsh:")])])]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("virsh dump domain_name --memory-only --format=kdump-zlib\n")])])])]),e._v(" "),a("p",[e._v("FYI: If your virsh utility doesn’t support --format option, just skip it:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("virsh dump domain_name --memory-only\n")])])])]),e._v(" "),a("ol",{attrs:{start:"7"}},[a("li",[e._v("Upload the dump onto the dump server.")])]),e._v(" "),a("h2",{attrs:{id:"how-to-add-java-to-cagefs"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#how-to-add-java-to-cagefs"}},[e._v("#")]),e._v(" How to add java to CageFS?")]),e._v(" "),a("p",[e._v("If you would like to make java available from inside CageFS, perform the following steps:")]),e._v(" "),a("ol",[a("li",[e._v("Create "),a("em",[e._v("/etc/cagefs/conf.d/java.cfg")]),e._v(" and add proper binary files to it:")])]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("$ vi /etc/cagefs/conf.d/java.cfg\n")])])]),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("[java-custom]\ncomment=Java-custom\npaths=/usr/bin/java, /etc/alternatives/java\n")])])])]),e._v(" "),a("ol",{attrs:{start:"2"}},[a("li",[e._v("Update skeleton and remount all:")])]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("$ cagefsctl --force-update\n$ cagefsctl --remount-all\n")])])])]),e._v(" "),a("h2",{attrs:{id:"php-selector-useful-commands"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#php-selector-useful-commands"}},[e._v("#")]),e._v(" PHP Selector useful commands")]),e._v(" "),a("ul",[a("li",[e._v("Getting current PHP version for a user:")])]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("selectorctl --user-current --user=UU\n")])])])]),e._v(" "),a("ul",[a("li",[e._v("Changing PHP version for a user:")])]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("selectorctl --set-user-current=5.3 --user=UU\n")])])])]),e._v(" "),a("ul",[a("li",[e._v("Enabling some extensions for a user:")])]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("selectorctl --enable-user-extensions=pdo,phar --version=5.3 --user=UU\n")])])])]),e._v(" "),a("p",[e._v("Extensions disabling is done the same way.")]),e._v(" "),a("ul",[a("li",[e._v("List user extensions:")])]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("selectorctl --list-user-extensions --version=5.3 --user=UU\n")])])])]),e._v(" "),a("ul",[a("li",[e._v("Replace option in users php.ini:")])]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("selectorctl --replace-options=log_errors:on,display_errors:on --version=5.3 --user=UU\n")])])])]),e._v(" "),a("ul",[a("li",[e._v("Enable some PHP module for all existing accounts (cPanel servers only):")])]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("# cd /var/cpanel/users; ls -1 | grep -v '^.' | awk '{ print \"selectorctl some_cool_keys --user=\"$1 }' | sh\n")])])])]),e._v(" "),a("p",[e._v("Servers with other control panels or non-panel:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("# for u in cat /etc/passwd|awk -F: '($3>=500)'| cut -f \"1\" -d :; do selectorctl some_cool_keys --user=$u; done\n")])])])]),e._v(" "),a("p",[e._v("where 'some_cool_keys' - any selectorctl options from "),a("router-link",{attrs:{to:"/command-line_tools/#selectorctl"}},[e._v("here")])],1),e._v(" "),a("ul",[a("li",[e._v("Reset user extensions to default settings:")])]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("selectorctl --list-users --version=5.6 | sed -e 's/,/\\n/g' | sed 's/^/selectorctl --reset-user-extensions --version=5.6 --user=/'\n")])])])]),e._v(" "),a("p",[e._v("If you run it:")]),e._v(" "),a("ol",[a("li",[a("p",[e._v("The script will generate a list of users who use PHP 5.6")])]),e._v(" "),a("li",[a("p",[e._v("The script will generate a separate command to reset the modules for each user")])]),e._v(" "),a("li",[a("p",[e._v("If you add | sh at the end of the command, the modules will be reset for all users that have PHP 5.6 Example:")])])]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("selectorctl --list-users --version=5.6 | sed -e 's/,/\\n/g' | sed 's/^/selectorctl --reset-user-extensions --version=5.6 --user=/' | sh\n")])])])]),e._v(" "),a("ul",[a("li",[e._v("Change PHP version for all users:")])]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("# selectorctl --change-to-version=5.3 --version=native #this command changes PHP version to 5.3 for all users with native version\n")])])])]),e._v(" "),a("p",[e._v("or, you can change PHP version for all users using the commands below:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("# cd /var/cpanel/users\n# ls -1 | awk '{ print \"selectorctl --set-user-current=5.3 --user=\"$1 }' | sh\n")])])])]),e._v(" "),a("h2",{attrs:{id:"how-to-install-cwp-centos-web-panel-and-configure-it-for-php-selector"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#how-to-install-cwp-centos-web-panel-and-configure-it-for-php-selector"}},[e._v("#")]),e._v(" How to install CWP (CentOS Web Panel) and configure it for PHP Selector?")]),e._v(" "),a("p",[e._v("CentOS Web Panel and its features are described on the official "),a("a",{attrs:{href:"http://centos-webpanel.com/features",target:"_blank",rel:"noopener noreferrer"}},[e._v("website"),a("OutboundLink")],1)]),e._v(" "),a("p",[e._v("The installation is straightforward:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("cd /usr/local/src\nwget http://dl1.centos-webpanel.com/files/cwp-latest.sh\nsh cwp-latest.sh\n")])])])]),e._v(" "),a("p",[e._v("During the install, it builds Apache and PHP from source. To make PHP Selector work we need to build patched suPHP:")]),e._v(" "),a("ul",[a("li",[e._v("download/unpack suPHP (0.7.1 an as example):")])]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("cd /usr/local/src/\nwget http://www.suphp.org/download/suphp-0.7.1.tar.gz\ncd suphp-0.7.1\n")])])])]),e._v(" "),a("ul",[a("li",[e._v("download/unpack our patches:")])]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("wget http://repo.cloudlinux.com/cloudlinux/sources/da/cl-apache-patches.tar.gz\ntar xfz cl-apache-patches.tar.gz\n")])])])]),e._v(" "),a("ul",[a("li",[e._v("apply our patch:")])]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("patch -p1 < suphp-0.7.1-cagefs.patch\n")])])])]),e._v(" "),a("ul",[a("li",[e._v("if apache 2.4 is used - modify configure file to adopt suPHP sources for it, open a file:")])]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("vi configure\n")])])])]),e._v(" "),a("ul",[a("li",[e._v("find section")])]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('    major_version=`echo $APACHE_VERSION|cut -f1,2 -d.`\n    if test "$major_version" = "2.0" -o "$major_version" = "2.2"; then\n      APACHE_VERSION_2=true\n      APACHE_VERSION_1_3=false\n    else\n      APACHE_VERSION_2=false\n      APACHE_VERSION_1_3=true\n')])])])]),e._v(" "),a("p",[e._v("and modify second line as follows:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('    if test "$major_version" = "2.0" -o "$major_version" = "2.2" -o "$major_version" = "2.4"; then\n')])])])]),e._v(" "),a("ul",[a("li",[e._v("build suphp:")])]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("./configure --with-apr=/usr/local/apr/ --with-apxs=/usr/local/apache/bin/apxs -with-setid-mode=paranoid --with-apache-user=nobody --with-gnu-ld --disable-checkpath --sysconfdir=/usr/local/etc --sbindir=/usr/local/sbin\nmake\nmake install\n")])])])]),e._v(" "),a("p",[e._v("When done, check if suPHP binary has necessary code, the output should be following:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("strings /usr/local/sbin/suphp | grep jail\n")])])])]),e._v(" "),a("p",[a("em",[a("code",[e._v("lve_jail_uid CageFS jail error")])])]),e._v(" "),a("p",[e._v("And change (create) "),a("em",[e._v("/etc/cl.selector/native.conf")]),e._v(" to look this way:")]),e._v(" "),a("p",[a("em",[a("code",[e._v("php=/usr/local/bin/php-cgi php-cli=/usr/local/bin/php php.ini=/usr/local/php/php.ini php-fpm=/usr/local/sbin/php-fpm")])])]),e._v(" "),a("h2",{attrs:{id:"how-to-manually-update-mod-hostinglimits-on-cpanel"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#how-to-manually-update-mod-hostinglimits-on-cpanel"}},[e._v("#")]),e._v(" How to manually update mod_hostinglimits on cPanel?")]),e._v(" "),a("p",[e._v("When we release an update for mod_hostinglimits, we send it to cPanel team to implement in EasyApache. Overall, the procedure requires some time due to quite complicated process. Here is the way to update mod_hostinglimits manually on cPanel servers. Check current version:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("strings /usr/local/apache/modules/mod_hostinglimits.so | grep version -i\n")])])])]),e._v(" "),a("p",[a("em",[a("code",[e._v("mod_hostinglimits: version 1.0-16. LVE mechanism enabled")])])]),e._v(" "),a("p",[e._v("Update from source (version 1.0-19 as an example):")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("wget http://repo.cloudlinux.com/cloudlinux/sources/da/mod_hostinglimits-1.0-19.tar.gz\ntar xfz mod_hostinglimits-1.0-19.tar.gz\ncd mod_hostinglimits-1.0-19\ncmake .\nmake\nmake install\n")])])])]),e._v(" "),a("p",[e._v("Check version:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("strings /usr/local/apache/modules/mod_hostinglimits.so | grep version -i\n")])])])]),e._v(" "),a("p",[a("em",[a("code",[e._v("mod_hostinglimits: version 1.0-19. LVE mechanism enabled")])])]),e._v(" "),a("p",[e._v("Finally, restart Apache to apply changes:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("/etc/init.d/httpd restart\n")])])])]),e._v(" "),a("h2",{attrs:{id:"how-to-move-opt-alt"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#how-to-move-opt-alt"}},[e._v("#")]),e._v(" How to move /opt/alt")]),e._v(" "),a("p",[e._v("In rare cases, customer wants to move "),a("em",[e._v("/opt/alt")]),e._v(" to a different place. To do this:")]),e._v(" "),a("ol",[a("li",[a("p",[e._v("Move "),a("em",[e._v("/opt/alt")]),e._v(" somewhere ("),a("code",[e._v("mv /opt/alt /var/opt_alt")]),e._v(").")])]),e._v(" "),a("li",[a("p",[e._v("Create "),a("em",[e._v("/opt/alt")]),e._v(" directory ("),a("code",[e._v("mkdir /opt/alt")]),e._v(").")])]),e._v(" "),a("li",[a("p",[e._v("Bind mount the new path to the old one: ("),a("code",[e._v("mount -o bind /var/opt_alt /opt/alt")]),e._v(").")])]),e._v(" "),a("li",[a("p",[e._v("Remount CageFS ("),a("code",[e._v("cagefsctl --remount-all")]),e._v(").")])]),e._v(" "),a("li",[a("p",[e._v("Add an entry to "),a("em",[e._v("/etc/fstab")]),e._v(", for example: "),a("code",[e._v("/var/opt_alt /opt/alt none bind 0 0")]),e._v(".")])])]),e._v(" "),a("h2",{attrs:{id:"how-do-i-enable-lve-and-php-selector-in-litespeed"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#how-do-i-enable-lve-and-php-selector-in-litespeed"}},[e._v("#")]),e._v(" How do I enable LVE and PHP Selector in LiteSpeed?")]),e._v(" "),a("p",[e._v("In LiteSpeed admin interface do the following:")]),e._v(" "),a("p",[a("em",[e._v('Configuration -> Server -> Edit -> "Enable LVE" = "Yes" -> Save')])]),e._v(" "),a("p",[e._v("If you are using CageFS, then choose cagefs there.")]),e._v(" "),a("p",[e._v("To enable PHP Selector with LiteSpeed you have to adjust more settings in Admin:")]),e._v(" "),a("ol",[a("li",[e._v("CloudLinux ("),a("em",[e._v("Admin Console --\x3e Configuration --\x3e Server --\x3e General")]),e._v("): CageFS;")]),e._v(" "),a("li",[e._v("Enable SuExec: "),a("em",[e._v("Server-> General -> PHP SuEXEC -> Yes")]),e._v(";")]),e._v(" "),a("li",[e._v("LSPHP5 external app runs in SUEXEC non-daemon mode ONLY ("),a("em",[e._v("Run On Start Up --\x3e Yes or No")]),e._v(");")]),e._v(" "),a("li",[e._v("In LSPHP5 external app ("),a("em",[e._v("Admin Console --\x3e Configuration --\x3e Server --\x3e External App --\x3e lsphp5")]),e._v(").")])]),e._v(" "),a("p",[e._v("Change")]),e._v(" "),a("p",[a("code",[e._v("command => $SERVER_ROOT/fcgi-bin/lsphp5")])]),e._v(" "),a("p",[e._v("To")]),e._v(" "),a("p",[a("code",[e._v("command => /usr/local/bin/lsphp")])]),e._v(" "),a("div",{staticClass:"tip custom-block"},[a("p",{staticClass:"custom-block-title"},[e._v("Note")]),a("p",[e._v("In order to use PHP Selector and custom php.ini, lsphp5 needs to be in SuEXEC non-daemon mode.")])]),a("div",{staticClass:"tip custom-block"},[a("p",{staticClass:"custom-block-title"},[e._v("Note")]),a("p",[e._v("Some PHP configurations require more memory for SuEXEC to work properly. If you are getting error 500 after switching suEXEC to non-daemon mode, try to increase Memory Soft Limit and Memory Hard Limit for external App (Admin Console --\x3e Configuration --\x3e Server --\x3e External App --\x3e lsphp5 ) to at least 650/800M.")])]),a("h2",{attrs:{id:"how-do-i-use-3rd-party-rpm-repositories-without-facing-conflicts"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#how-do-i-use-3rd-party-rpm-repositories-without-facing-conflicts"}},[e._v("#")]),e._v(" How do I use 3rd party RPM repositories without facing conflicts?")]),e._v(" "),a("p",[e._v("To protect packages from CloudLinux repositories from being updated from 3rd party repositories like rpmforge, and to prevent such dependencies issues, do the following:")]),e._v(" "),a("p",[a("strong",[e._v("For CloudLinux OS 6.x")])]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("# yum install yum-plugin-protectbase\n")])])])]),e._v(" "),a("p",[e._v("Edit "),a("em",[e._v("/etc/yum/pluginconf.d/rhnplugin.conf")]),e._v(". Add:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("[cloudlinux-x86_64-server-6]\nprotect = 1\n\n[cloudlinux-base]\nprotect = 1\n")])])])]),e._v(" "),a("p",[a("strong",[e._v("For CloudLinux OS 7.x")])]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("# yum install yum-plugin-protectbase\n")])])])]),e._v(" "),a("p",[e._v("Edit "),a("em",[e._v("/etc/yum/pluginconf.d/rhnplugin.conf")]),e._v(", add:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("[cloudlinux-x86_64-server-7]\nprotect = 1\n\n[cloudlinux-base]\nprotect = 1\n")])])])]),e._v(" "),a("h2",{attrs:{id:"how-can-i-run-service-inside-lve"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#how-can-i-run-service-inside-lve"}},[e._v("#")]),e._v(" How can I run service inside LVE?")]),e._v(" "),a("p",[e._v("It is possible to wrap service in LVE using lve-wrappers. To do that, install lve-wrappers first:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("# yum install lve-wrappers\n")])])])]),e._v(" "),a("p",[e._v("Then rename service that you want to wrap like:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("# mv /etc/init.d/[service_name] /etc/init.d/[service_name].orig\n")])])])]),e._v(" "),a("p",[e._v("Create a new script to start service instead:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("# cat <<END > /etc/init.d/[service_name]\n#!/bin/sh\nlve_suwrapper [LVE_ID] /etc/init.d/[service_name].orig $@\nEND\n\n# chmod +x /etc/init.d/[service_name]\n\n# service [service_name] restart\n")])])])]),e._v(" "),a("p",[e._v("That should be it.\nYou can specify any number as LVE_ID, just make it large enough so it would not clash with the user ID from "),a("em",[e._v("/etc/passwd")]),e._v(" file.")]),e._v(" "),a("h2",{attrs:{id:"how-do-i-configure-cloudlinux-kernel-on-xen-pv"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#how-do-i-configure-cloudlinux-kernel-on-xen-pv"}},[e._v("#")]),e._v(" How do I configure CloudLinux kernel on Xen PV?")]),e._v(" "),a("ol",[a("li",[e._v("In "),a("em",[e._v("/etc/sysconfig/kernel")]),e._v(" should be the following lines:")])]),e._v(" "),a("p",[a("em",[a("code",[e._v("UPDATEDEFAULT=yes DEFAULTKERNEL=kernel-xen")])])]),e._v(" "),a("p",[e._v("If the file does not exist, you should create it.")]),e._v(" "),a("ol",{attrs:{start:"2"}},[a("li",[e._v("Install grub if it is not installed:")])]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("yum install grub\n")])])])]),e._v(" "),a("ol",{attrs:{start:"3"}},[a("li",[e._v("Check "),a("em",[e._v("/etc/modprobe.conf")]),e._v(", it usually contains the following:")])]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("cat /etc/modprobe.conf\n")])])])]),e._v(" "),a("p",[a("em",[a("code",[e._v("alias eth0 xennet alias scsi_hostadapter xenblk")])])]),e._v(" "),a("p",[e._v("If the file does not exist - create it, and then, in case you have not installed kernel yet - proceed to step "),a("strong",[e._v("4")]),e._v(".")]),e._v(" "),a("p",[e._v("In case you have already installed kernel, rebuild initrd image:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("mkinitrd -f /boot/initrd-2.6.xxxx.img 2.6.xxxx\n")])])])]),e._v(" "),a("p",[e._v("where "),a("code",[e._v("xxxx")]),e._v(" should be the same as you newly installed "),a("code",[e._v("kernel-xen")]),e._v(" version and move to step "),a("strong",[e._v("5")]),e._v(".")]),e._v(" "),a("ol",{attrs:{start:"4"}},[a("li",[e._v("Run")])]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("yum install kernel-xen\n")])])])]),e._v(" "),a("ol",{attrs:{start:"5"}},[a("li",[e._v("Run")])]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("ln -s /boot/grub/grub.conf /boot/grub/menu.lst\nln -s /boot/grub/grub.conf /etc/grub.conf\n")])])])]),e._v(" "),a("p",[e._v("If "),a("em",[e._v("/boot/grub/grub.conf")]),e._v(" does not exist, create it using the template in step 5, and repeat step 3.")]),e._v(" "),a("ol",{attrs:{start:"6"}},[a("li",[e._v("Run")])]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("rpm -qa|grep kernel\n")])])])]),e._v(" "),a("p",[e._v("You should remove all kernels except Xen kernel. For example, if the output looks like this:")]),e._v(" "),a("p",[a("em",[a("code",[e._v("kernel-2.6.18-338.5.1.el5.lve0.8.25 kernel-xen-2.6.18-374.3.1.el5.lve0.8.44 kernel-headers-2.6.18-374.3.1.el5.lve0.8.44")])]),e._v("\nthen you should run")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("rpm -e --nodeps kernel-2.6.18-338.5.1.el5.lve0.8.25\n")])])])]),e._v(" "),a("ol",{attrs:{start:"7"}},[a("li",[e._v("Make sure your "),a("em",[e._v("/etc/grub.conf")]),e._v(" looks like this:")])]),e._v(" "),a("p",[a("em",[a("code",[e._v("default=0 timeout=10 title CloudLinux Server (2.6.18-374.3.1.el5.lve0.8.44xen) root (hd0,0) kernel /boot/vmlinuz-2.6.18-374.3.1.el5.lve0.8.44xen console=xvc0 root=/dev/sda1 ro initrd /boot/initrd-2.6.18-374.3.1.el5.lve0.8.44xen.img")])])]),e._v(" "),a("div",{staticClass:"tip custom-block"},[a("p",{staticClass:"custom-block-title"},[e._v("Note")]),a("p",[e._v("Mind the kernel version on vmlinuz and initrd, they should match the version of currently installed kernel.")])]),a("ol",{attrs:{start:"8"}},[a("li",[e._v("Switch to pygrub mode, and reboot the server. If you don't know how to switch in pygrub mode, contact your service provider, as they should be able to do it for you.")])]),e._v(" "),a("p",[a("em",[a("code",[e._v("bootloader = '/usr/bin/pygrub'")])])]),e._v(" "),a("h2",{attrs:{id:"how-do-i-install-hyper-v-integrated-components"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#how-do-i-install-hyper-v-integrated-components"}},[e._v("#")]),e._v(" How do I install Hyper-V integrated components?")]),e._v(" "),a("p",[e._v("Hyper-V integrated components are included in the latest version of CloudLinux OS 6.")]),e._v(" "),a("p",[e._v("No additional actions required to install them.")]),e._v(" "),a("h2",{attrs:{id:"how-do-i-move-usr-share-cagefs-skeleton-to-other-place-because-of-low-disk-space"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#how-do-i-move-usr-share-cagefs-skeleton-to-other-place-because-of-low-disk-space"}},[e._v("#")]),e._v(" How do I move /usr/share/cagefs-skeleton to other place because of low disk space?")]),e._v(" "),a("div",{staticClass:"tip custom-block"},[a("p",{staticClass:"custom-block-title"},[e._v("Note")]),a("p",[e._v('If you are placing skeleton in /home directory on cPanel servers, you must configure the following option in cPanel WHM:\nWHM -> Server Configuration -> Basic cPanel/WHM Setup -> Basic Config -> Additional home directories\nChange the value to blank (not to default "Home").\nWithout changing this option, cPanel will create new accounts in incorrect places.')])]),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("cagefsctl --disable-cagefs\ncagefsctl --unmount-all\n")])])])]),e._v(" "),a("p",[e._v("Verify that the following command gives empty output:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("cat /proc/mounts | grep cagefs-skeleton\n")])])])]),e._v(" "),a("p",[e._v("Verify that the directory "),a("code",[e._v("cagefs-skeleton.bak")]),e._v(" does not exist (if it does exist - change the name "),a("code",[e._v("cagefs-skeleton.bak")]),e._v(" to something else):")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("ls -d /usr/share/cagefs-skeleton.bak\n\nmv /usr/share/cagefs-skeleton /usr/share/cagefs-skeleton.bak\n\nmkdir -m 0755 /home/cagefs-skeleton\nln -s /home/cagefs-skeleton /usr/share/cagefs-skeleton\ncagefsctl --init\ncagefsctl --enable-cagefs\ncagefsctl --remount-all\n")])])])]),e._v(" "),a("p",[e._v("Verify that the following command gives empty output:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("cat /proc/mounts | grep cagefs-skeleton.bak\n")])])])]),e._v(" "),a("p",[e._v("Now you can safely remove "),a("code",[e._v("cagefs-skeleton.bak")]),e._v(" directory:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("rm -rf /usr/share/cagefs-skeleton.bak\n")])])])]),e._v(" "),a("h2",{attrs:{id:"how-do-i-move-user-s-home-folder-to-another-location-if-i-have-cagefs-installed"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#how-do-i-move-user-s-home-folder-to-another-location-if-i-have-cagefs-installed"}},[e._v("#")]),e._v(" How do I move user's home folder to another location if I have CageFS installed?")]),e._v(" "),a("p",[e._v("You can move home directories of the users in the following way:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("cagefsctl --disable username1 username2\ncagefsctl --unmount username1 username2\n")])])])]),e._v(" "),a("p",[e._v("Move home directories to a new location, edit "),a("em",[e._v("/etc/passwd")]),e._v(" to reflect new path then enable CageFS:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("cagefsctl --update-etc username1 username2\ncagefsctl --enable username1 username2\n")])])])]),e._v(" "),a("h2",{attrs:{id:"how-to-install-xen-tools-guest-utilities-on-citrix-xenserver-6-1-or-xen-cloud-platform-6-1"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#how-to-install-xen-tools-guest-utilities-on-citrix-xenserver-6-1-or-xen-cloud-platform-6-1"}},[e._v("#")]),e._v(" How to install Xen tools (guest utilities) on Citrix Xenserver 6.1 or Xen Cloud Platform 6.1?")]),e._v(" "),a("p",[e._v("To install guest utilities, mount as usually CD ROM with tools to "),a("em",[e._v("/mnt/cdrom/")]),e._v(". Then do the following:")]),e._v(" "),a("ol",[a("li",[e._v("Enter cdrom mounted location:")])]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("cd  /mnt/cdrom/Linux\n")])])])]),e._v(" "),a("p",[e._v("Install needed software, use '-m 6' for CloudLinux OS 6:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("./install.sh -d rhel -m 6\n")])])])]),e._v(" "),a("h2",{attrs:{id:"how-do-i-calculate-reasonable-inode-limit"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#how-do-i-calculate-reasonable-inode-limit"}},[e._v("#")]),e._v(" How do I calculate reasonable inode limit?")]),e._v(" "),a("p",[e._v("Inode limit can be considered as a number of files and directories one customer can own. Default WordPress installation has approximately 1,100 files/directories, default Magento install is 10,000, you would need to consider at least 30,000 to be an inode limit for a minimal package for your customers. You can calculate limits basing on current usage of your customers by running the following command. It will list top 50 entries that use inodes the most:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("repquota -a | grep -v root | awk '{print $6\" \"$1 }' | sort -g | tail -50\n")])])])]),e._v(" "),a("p",[e._v("Do not forget - temporary files and session files are also counted towards the inode limit.")]),e._v(" "),a("h2",{attrs:{id:"how-do-i-create-local-cloudlinux-repository-mirror"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#how-do-i-create-local-cloudlinux-repository-mirror"}},[e._v("#")]),e._v(" How do I create local CloudLinux repository mirror?")]),e._v(" "),a("p",[e._v("CloudLinux mirror requires a bit more than a typical repository mirror setup. We set up CLN proxy software to accommodate for authentication done by "),a("code",[e._v("yum-rhn-plugin")]),e._v(" plugin.")]),e._v(" "),a("p",[e._v("::: danger Important\nTo qualify as a CLN mirror, you need to have more than 50 servers in your datacenters.\n:::")]),e._v(" "),a("p",[e._v("To host a mirror, please setup:")]),e._v(" "),a("ul",[a("li",[e._v("a VM with 4GB of RAM and 200GB of disk space running CentOS 7;")]),e._v(" "),a("li",[e._v('"firewalld" service should be running with sshd enabled;')]),e._v(" "),a("li",[e._v("domain name pointed to that mirror, like cl-mirror.yourdomain.com;")])]),e._v(" "),a("p",[e._v("Then create a support ticket and send us:")]),e._v(" "),a("ul",[a("li",[e._v("your CLN login name;")]),e._v(" "),a("li",[e._v("access to VM;")]),e._v(" "),a("li",[e._v("domain name pointed to that VM.")])]),e._v(" "),a("p",[e._v("We will setup a software that would act as a caching proxy allowing licensing to work. When done, your mirror will be added to the "),a("a",{attrs:{href:"http://repo.cloudlinux.com/cloudlinux/mirrorlists/cln-mirrors",target:"_blank",rel:"noopener noreferrer"}},[e._v("mirror list"),a("OutboundLink")],1)]),e._v(" "),a("p",[e._v("ETA is about 2-3 business days.")]),e._v(" "),a("h2",{attrs:{id:"how-do-i-install-cloudlinux-from-scratch-or-convert-existing-server"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#how-do-i-install-cloudlinux-from-scratch-or-convert-existing-server"}},[e._v("#")]),e._v(" How do I install CloudLinux from scratch or convert existing server?")]),e._v(" "),a("p",[e._v("To install CloudLinux OS on a new server you have to download and use provided .iso files. The files themselves and all the necessary information you can find "),a("router-link",{attrs:{to:"/cloudlinux_installation/#installing-new-servers"}},[e._v("here")]),e._v(".")],1),e._v(" "),a("p",[e._v("To convert existing server you need to download and run our script, which you can find "),a("router-link",{attrs:{to:"/cloudlinux_installation/#converting-existing-servers"}},[e._v("here")]),e._v(" with all the necessary instructions.")],1),e._v(" "),a("p",[e._v("Also, we provide a variety of different images for most common virtual machines, more information "),a("router-link",{attrs:{to:"/cloudlinux_installation/#cloudlinux-os-images"}},[e._v("here")]),e._v(".")],1),e._v(" "),a("h2",{attrs:{id:"how-do-i-install-vmware-tools-improving-server-performance-when-on-vmware"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#how-do-i-install-vmware-tools-improving-server-performance-when-on-vmware"}},[e._v("#")]),e._v(" How do I install VMware-Tools/Improving server performance when on VMware?")]),e._v(" "),a("p",[e._v("If you notice some server slowing down (IO/memory) and this server is running on VMware, then we strongly recommend you to install "),a("a",{attrs:{href:"https://kb.vmware.com/s/article/340",target:"_blank",rel:"noopener noreferrer"}},[e._v("VMware-Tools"),a("OutboundLink")],1),e._v(" - a suite of utilities that enhance the performance of VM guest operating system and improves its management.")]),e._v(" "),a("p",[e._v("Check if they are installed and kernel modules are loaded, where "),a("code",[e._v("vmci")]),e._v(" is the main one:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("# lsmod | grep vm\n")])])])]),e._v(" "),a("p",[a("em",[a("code",[e._v("vmci 80373 1 vsock")])])]),e._v(" "),a("p",[e._v("If you see no "),a("code",[e._v("vmci")]),e._v(" in the output, then most probably they are not installed.")]),e._v(" "),a("p",[e._v("We do recommend installing them from source code using this "),a("a",{attrs:{href:"https://kb.vmware.com/s/article/1018414",target:"_blank",rel:"noopener noreferrer"}},[e._v("article"),a("OutboundLink")],1)]),e._v(" "),a("p",[e._v("Installation process:")]),e._v(" "),a("p",[e._v("Click in "),a("em",[e._v("VM menu > Guest > Install/Upgrade VMware tools")]),e._v(" (at least). After that, the cdrom will be attached as "),a("em",[e._v("/dev/cdrom")]),e._v(". Mount it:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("mkdir /mnt/cdrom\nmount /dev/cdrom /mnt/cdrom\n")])])])]),e._v(" "),a("p",[e._v("Then install kernel headers and VMware-Tools:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("yum install kernel-headers\ncd /mnt/cdrom/vmware-tools-distrib\n./vmware-install.pl\n")])])])]),e._v(" "),a("p",[e._v("Follow the wizard (pressing enter in most cases), make them enabled on startup.")]),e._v(" "),a("p",[e._v("Check if "),a("code",[e._v("vmci")]),e._v(" exists in lsmod.")]),e._v(" "),a("p",[e._v("If you see tools installed but no module loaded - run the configuration from the command line:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("vmware-config-tools.pl\n")])])])]),e._v(" "),a("h2",{attrs:{id:"how-do-i-convert-linode-centos-vps-to-cloudlinux"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#how-do-i-convert-linode-centos-vps-to-cloudlinux"}},[e._v("#")]),e._v(" How do I convert Linode CentOS VPS to CloudLinux?")]),e._v(" "),a("p",[e._v("For CentOS 6, please do the following steps:")]),e._v(" "),a("ol",[a("li",[e._v("Install packages:")])]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("yum install kernel grub\n")])])])]),e._v(" "),a("ol",{attrs:{start:"2"}},[a("li",[e._v("Make sure that your "),a("em",[e._v("/boot/grub/grub.conf")]),e._v(" looks like this (if it does not exist, you should create it):")])]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("default=0\ntimeout=10\ntitle CentOS Server (2.6.32-279.5.2)\nroot (hd0)\nkernel /boot/vmlinuz-2.6.32-279.5.2.el6.i686 root=/dev/xvda ro\ninitrd /boot/initramfs-2.6.32-279.5.2.el6.i686.img\n")])])])]),e._v(" "),a("ol",{attrs:{start:"3"}},[a("li",[e._v("Create symlinks:")])]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("ln -s /boot/grub/grub.conf /boot/grub/menu.lst; ln -s /boot/grub/grub.conf /etc/grub.conf\n")])])])]),e._v(" "),a("p",[e._v("Once you are done, in the Linode Manager, edit your Linode configuration profile to use "),a("code",[e._v("pv-grub-x86_64")]),e._v(" (or 32-bit one if you use 32-bit arch) as the Kernel.")]),e._v(" "),a("p",[e._v("Make sure the root device is specified as "),a("code",[e._v("xvda")]),e._v(". Save your changes by clicking "),a("em",[e._v("Save Profile")]),e._v(" at the bottom of the page, and reboot your Linode from the "),a("em",[e._v("Dashboard")]),e._v(" tab.")]),e._v(" "),a("h2",{attrs:{id:"how-do-i-view-lveinfo-for-more-than-10-users"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#how-do-i-view-lveinfo-for-more-than-10-users"}},[e._v("#")]),e._v(" How do I view lveinfo for more than 10 users?")]),e._v(" "),a("p",[e._v("By default when you run "),a("code",[e._v("lveinfo")]),e._v(", it assumes "),a("code",[e._v("--limit=10")]),e._v(", and shows only top 10 results. So, if you want to see more, just add "),a("code",[e._v("--limit 1000")]),e._v(" like:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("# lveinfo --period=1d --limit 1000\n")])])])]),e._v(" "),a("p",[e._v("Also, it is possible to create a graphical chart for the particular user. You can use this command:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("# lvechart -u USERNAME --period=1d --width=12 -o chart-USERNAME.png\n")])])])]),e._v(" "),a("h2",{attrs:{id:"how-do-i-enable-pygrub-in-hypervm"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#how-do-i-enable-pygrub-in-hypervm"}},[e._v("#")]),e._v(" How do I enable pygrub in HyperVM?")]),e._v(" "),a("p",[e._v("To enable "),a("code",[e._v("pygrub")]),e._v(", please go to "),a("em",[e._v("Advanced --\x3e Append To Xen Config")]),e._v(" and enter the line:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('bootloader = "/usr/bin/pygrub"\n')])])])]),e._v(" "),a("p",[e._v("Then click "),a("em",[e._v("Update")]),e._v(" and reboot the VM. Also, change one line in VM "),a("em",[e._v("/boot/grub/grub.conf")]),e._v(" file: "),a("code",[e._v("root (hd0,0)")]),e._v(" to "),a("code",[e._v("root (hd0)")])]),e._v(" "),a("div",{staticClass:"tip custom-block"},[a("p",{staticClass:"custom-block-title"},[e._v("Note")]),a("p",[e._v("This is only for HyperVM ver2.0, pygrub is officially supported in ver2.2.x")])]),a("h2",{attrs:{id:"how-do-i-set-resize-my-aws-instance-storage-size"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#how-do-i-set-resize-my-aws-instance-storage-size"}},[e._v("#")]),e._v(" How do I set/resize my AWS instance storage size?")]),e._v(" "),a("p",[e._v("Before starting your instance, you can choose storage size in the "),a("em",[e._v("Storage")]),e._v(" section.")]),e._v(" "),a("p",[e._v("If your instance is already running, please refer to Amazon's "),a("a",{attrs:{href:"http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ebs-expand-volume.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("official instruction"),a("OutboundLink")],1)]),e._v(" "),a("h2",{attrs:{id:"how-to-install-and-configure-kdump-to-obtain-vmcore"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#how-to-install-and-configure-kdump-to-obtain-vmcore"}},[e._v("#")]),e._v(" How to install and configure kdump to obtain vmcore?")]),e._v(" "),a("p",[e._v("If you have a non-responding server and no useful errors are shown in "),a("em",[e._v("/var/log/messages")]),e._v(", the way to find the reason is to install and configure "),a("code",[e._v("kdump")]),e._v(", so it will create a core dump file when the server hangs. In some cases "),a("code",[e._v("kdump")]),e._v(" could not help on XEN PV machines, however, in any case, you should try it as on regular servers it is really doing a good job. Here are the steps to install and configure kdump:")]),e._v(" "),a("ol",[a("li",[e._v("Install kexec-tools:")])]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("yum install kexec-tools\n")])])])]),e._v(" "),a("p",[e._v("Edit "),a("em",[e._v("/etc/kdump.conf")]),e._v(", and set the path variable to point to a directory with enough space to hold kernel dump file (default location is "),a("em",[e._v("/var/crash/")]),e._v("). File size will be about the size of the server RAM + 1GB.")]),e._v(" "),a("ol",{attrs:{start:"2"}},[a("li",[e._v("Edit /etc/grub.conf.")])]),e._v(" "),a("p",[e._v("For CloudLinux OS 6 add to the kernel line as another boot parameter or modify existing one:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("crashkernel=160M (or crashkernel=auto)\n")])])])]),e._v(" "),a("p",[e._v("For CloudLinux OS 7 edit "),a("em",[e._v("/etc/default/grub")]),e._v(" and add "),a("code",[e._v("crashkernel=auto")]),e._v(" to "),a("code",[e._v("GRUB_CMDLINE_LINUX")]),e._v(" parameter (or modify existing one) so it should look like this:")]),e._v(" "),a("p",[a("em",[a("code",[e._v('GRUB_CMDLINE_LINUX="crashkernel=auto rhgb quiet"')])])]),e._v(" "),a("p",[e._v("Here is the link to the official RHEL recommendation regarding the crashkernel value: "),a("a",{attrs:{href:"https://access.redhat.com/solutions/916043",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://access.redhat.com/solutions/916043"),a("OutboundLink")],1)]),e._v(" "),a("p",[e._v("Rebuild grub config file with the following command:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("grub2-mkconfig -o /boot/grub2/grub.cfg\n")])])])]),e._v(" "),a("ol",{attrs:{start:"3"}},[a("li",[e._v("For CloudLinux OS 6 - add "),a("code",[e._v("kdump")]),e._v(" to "),a("code",[e._v("chkconfig")]),e._v(" and turn it "),a("strong",[e._v("On")]),e._v(" during boot:")])]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("chkconfig --add kdump\nchkconfig kdump on\n")])])])]),e._v(" "),a("ol",{attrs:{start:"4"}},[a("li",[e._v("Modify "),a("em",[e._v("/etc/sysctl.conf")]),e._v(" file and add the following block to catch all possible panic states:")])]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("# Enable reboots on panic to allow kdump make dumps\nkernel.sysrq=1\nkernel.hung_task_panic = 1\nkernel.panic = 1\nkernel.panic_on_io_nmi = 1\nkernel.panic_on_oops = 1\nkernel.panic_on_stackoverflow = 1\nkernel.panic_on_unrecovered_nmi = 1\nkernel.softlockup_panic = 1\nkernel.unknown_nmi_panic = 1\n")])])])]),e._v(" "),a("ol",{attrs:{start:"5"}},[a("li",[e._v("Reboot.\nAfter the server boot check if kdump is running with:")])]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("service kdump status\n")])])])]),e._v(" "),a("p",[e._v("Obtaining coredump if server hangs is described "),a("router-link",{attrs:{to:"/kb/HowDoI/#how-to-obtain-kdump-if-server-hangs"}},[e._v("here")]),e._v(".")],1),e._v(" "),a("h2",{attrs:{id:"how-to-obtain-vmcore-when-the-server-is-unresponsive"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#how-to-obtain-vmcore-when-the-server-is-unresponsive"}},[e._v("#")]),e._v(" How To Obtain Vmcore When the Server is Unresponsive?")]),e._v(" "),a("p",[e._v("Assuming you already have kdump configured and functioning.")]),e._v(" "),a("p",[e._v("If you need to generate a coredump from a server without physical access to it, you may want to allow the kernel to call the panic routine when it receives an unknown non-maskable interrupt (NMI). In order to allow it, you have to edit "),a("em",[e._v("/etc/sysctl.conf")]),e._v(" and add the following line:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("kernel.unknown_nmi_panic = 1\n")])])])]),e._v(" "),a("p",[e._v("Apply changes with:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("sysctl -p\n")])])])]),e._v(" "),a("p",[e._v("To generate a core you may use some web-based 'KVM' services, most of them have the ability to send NMI to host. Another possible way in case of IPMI has been configured is to send unknown NMI with the "),a("code",[e._v("impitool")]),e._v(" command:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("ipmitool -I lan -H <hostname> chassis power diag\n")])])])]),e._v(" "),a("p",[e._v("In the case of "),a("em",[a("code",[e._v('"BUG: soft lockup - CPU#7 stuck for 67s"')])]),e._v(" messages in "),a("em",[e._v("/var/log/message")]),e._v(", you need to switch "),a("code",[e._v("kernel.softlockup_panic")]),e._v(" to "),a("code",[e._v("1")]),e._v(" to have the core file created automatically. To achieve that, edit "),a("em",[e._v("/etc/sysctl.conf")]),e._v(" and insert the following line:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("kernel.softlockup_panic = 1\n")])])])]),e._v(" "),a("p",[e._v("Apply changes with:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("sysctl -p\n")])])])]),e._v(" "),a("h2",{attrs:{id:"how-to-upgrade-cloudlinux-os-6-to-cloudlinux-os-7"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#how-to-upgrade-cloudlinux-os-6-to-cloudlinux-os-7"}},[e._v("#")]),e._v(" How to upgrade CloudLinux OS 6 to CloudLinux OS 7?")]),e._v(" "),a("p",[e._v("There is no direct upgrade path from CloudLinux OS 6 to CloudLinux OS 7, therefore the only way is to move accounts to a new server with CloudLinux OS 7 installed.")]),e._v(" "),a("p",[e._v("This is due to the fact that a large number of 3rd party components (such as control panels) are installed on a typical CloudLinux OS 7 server, which makes it impossible to gracefully upgrade the OS without breaking control panels.")]),e._v(" "),a("p",[e._v("We will work to improving the situation in the future, yet it depends on the collaboration of control panel providers.")]),e._v(" "),a("h2",{attrs:{id:"how-do-i-choose-which-kernel-to-boot-on-cloudlinux-os-7"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#how-do-i-choose-which-kernel-to-boot-on-cloudlinux-os-7"}},[e._v("#")]),e._v(" How do I choose which kernel to boot on CloudLinux OS 7?")]),e._v(" "),a("p",[e._v("CloudLinux OS 7 brings GRUB2 with the totally new scheme of booting the kernels, the old edit file is not applicable anymore. The correct way to boot needed kernel (use an older kernel, CentOS kernel one or debug kernel) is with "),a("code",[e._v("grub2-set-default")]),e._v(" command.")]),e._v(" "),a("ol",[a("li",[e._v("Take a needed kernel with :")])]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('$ awk -F\\\' \'$1=="menuentry " {print i++ " =  "$2}\' /etc/grub2.cfg\n')])])]),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("0 =  CloudLinux (3.10.0-427.18.2.lve1.4.27.el7.x86_64) 7.3 (Yury Malyshev)\n1 =  CloudLinux (3.10.0-427.36.1.lve1.4.26.el7.x86_64) 7.3 (Yury Malyshev)\n2 =  CloudLinux (3.10.0-427.18.2.lve1.4.24.el7.x86_64) 7.2 (Valeri Kubasov)\n3 =  CloudLinux (0-rescue-1d7e5b9aa3bd48e99e108700e5458d82) 7.2 (Valeri Kubasov)\n")])])])]),e._v(" "),a("div",{staticClass:"tip custom-block"},[a("p",{staticClass:"custom-block-title"},[e._v("Note")]),a("p",[e._v("The position of a menu entry in the list is denoted by a number starting with zero, so we are numbering it especially in a correct way.")])]),a("ol",{attrs:{start:"2"}},[a("li",[e._v("Set to boot needed kernel with command line:")])]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("$ grub2-set-default 1\n")])])])]),e._v(" "),a("p",[e._v("Use the following command to check currently selected kernel to be booted:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("$ grub2-editenv list\n")])])]),a("p",[a("code",[e._v("saved_entry=1")])])]),e._v(" "),a("p",[e._v("More information about customizing GRUB2 could be found in the "),a("a",{attrs:{href:"https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/7/html/System_Administrators_Guide/sec-Customizing_the_GRUB_2_Configuration_File.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("official RedHat guide"),a("OutboundLink")],1),e._v(".")]),e._v(" "),a("h2",{attrs:{id:"sharing-more-directories-with-single-user-account-over-cagefs"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#sharing-more-directories-with-single-user-account-over-cagefs"}},[e._v("#")]),e._v(" Sharing more directories with single user account over CageFS")]),e._v(" "),a("p",[e._v("Due to a design CageFS mounts user homes as "),a("em",[e._v("/home/username")]),e._v(", no matter in which "),a("em",[e._v("/home2/ .. /homeN/")]),e._v(" user reside on a real system.")]),e._v(" "),a("p",[e._v("This could cause some PHP scripts to work incorrectly, however, CageFS has a mechanism to make any additional location with users content available from inside. This is also a quite useful way to share needed backup directories for users if you are giving FTP/SSH access to them. Also, you can use this feature to provide access to "),a("em",[e._v("/homeabc/username")]),e._v(" when "),a("em",[e._v("/home/username")]),e._v(" is a symlink to it.")]),e._v(" "),a("p",[e._v("To enable this feature the following line should be added to "),a("em",[e._v("/etc/cagefs/cagefs.mp")]),e._v(" file:")]),e._v(" "),a("p",[a("code",[e._v("%/homeabc")])]),e._v(" "),a("p",[e._v("Then remount all with:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("cagefsctl --remount-all\n")])])])]),e._v(" "),a("p",[e._v("After that, a user can see both his "),a("em",[e._v("/home/username")]),e._v(" and "),a("em",[e._v("/homeabc/username")]),e._v(" from CageFS inside. Other directories in "),a("em",[e._v("/homeabc")]),e._v(" as well as in "),a("em",[e._v("/home")]),e._v(" will be still hidden for him.")]),e._v(" "),a("h2",{attrs:{id:"how-cpu-usage-is-calculated"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#how-cpu-usage-is-calculated"}},[e._v("#")]),e._v(" How CPU usage is calculated?")]),e._v(" "),a("p",[e._v("How to prove CPU usage is correct and it shows real data with "),a("code",[e._v("lveinfo")]),e._v("? Let us explain how "),a("code",[e._v("lvetop")]),e._v(" works before answering this question.")]),e._v(" "),a("p",[e._v("The "),a("code",[e._v("lvetop")]),e._v(" utility, as well as "),a("code",[e._v("lveps -d")]),e._v(", show dynamic CPU (and other) usage, collected during 3 seconds period. Before iteration, the process gets running PIDs/threads (let's call them list1), and after iteration, it gets them again (list2). If the thread is in both list1 and list2 it will show some CPU%. If the thread is only in list1 but is not in list2, then it is shown as NA. All newly created threads that exist in list2 but are absent in list1 will not be shown.")]),e._v(" "),a("p",[e._v("Without '-d' key it shows static processes/threads that are running 'now'. The values in CPU column (yellow square in this example) are the number of seconds LVE/process/thread has been running. This is an increasing counter and is reset with a reboot or with "),a("code",[e._v("lvectl destroy UID/all")]),e._v(". Overall, it is not a trivial task to show all the processes that generate CPU usage for any LVE, and process accounting is not cheap for the system. To summarize - there is no way to prove CPU usage shown in "),a("code",[e._v("lveinfo")]),e._v("/"),a("code",[e._v("lvetop")]),e._v(", like for example "),a("router-link",{attrs:{to:"/kb/HowDoI/#checking-personal-users-disk-cache-if-lveinfo-show-memory-usage-but-no-processes-there/"}},[e._v("memory usage")]),e._v(":")],1),e._v(" "),a("h2",{attrs:{id:"high-iowait-and-or-load-average-when-apc-enabled-in-php-selector"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#high-iowait-and-or-load-average-when-apc-enabled-in-php-selector"}},[e._v("#")]),e._v(" High iowait and/or load average when APC enabled in PHP Selector")]),e._v(" "),a("p",[e._v("If you are experiencing high iowait or high IO usage by single LVE or load average jumps after enabling APC, the most probable reason is due to the following directive in "),a("em",[e._v("/opt/alt/php5*/etc/php.d.all/apc.ini")]),e._v(":")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("apc.mmap_file_mask = /tmp/apc.shm.XXXXXX\n")])])])]),e._v(" "),a("p",[e._v("There are internet articles related to the same subject, like "),a("a",{attrs:{href:"http://serverfault.com/questions/361032/high-disk-i-o-when-cache-is-used",target:"_blank",rel:"noopener noreferrer"}},[e._v("this"),a("OutboundLink")],1),e._v(". We decided to change it to "),a("em",[e._v("/dev/zero")]),e._v(" by default, the same will be applied to all new installations. For existing installs you have to edit each "),a("em",[e._v("/opt/alt/php5*/etc/php.d.all/apc.ini")]),e._v(" and then execute:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("cagefsctl --rebuild-alt-php-ini\n")])])])]),e._v(" "),a("h2",{attrs:{id:"why-alt-php-ini-files-become-overwritten-after-alt-php-updates"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#why-alt-php-ini-files-become-overwritten-after-alt-php-updates"}},[e._v("#")]),e._v(" Why alt-php.ini files become overwritten after Alt-PHP updates?")]),e._v(" "),a("p",[e._v("During Alt-PHP packages update, we don't rewrite "),a("em",[e._v("*ini")]),e._v(" files at all. Only two PHP variables are reset to the values from the native "),a("em",[e._v("php.ini")]),e._v(" file, they are "),a("code",[e._v("error_log")]),e._v(" and "),a("code",[e._v("date.timezone")]),e._v(".")]),e._v(" "),a("p",[e._v("To prevent this situation, you should define "),a("code",[e._v("error_log")]),e._v(" and "),a("code",[e._v("date.timezone")]),e._v(" values in "),a("em",[e._v("/etc/cl.selector/global_php.ini")]),e._v(" file and run the following command to apply changes:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("cagefsctl --setup-cl-selector\n")])])])]),e._v(" "),a("p",[e._v("As a result, all settings from the files above will be taken for "),a("em",[e._v("*ini")]),e._v(" files for all versions inside PHP-Selector.")]),e._v(" "),a("p",[e._v("The current incarnation of PHP Selector is that it will not overwrite Alt-PHP ini files if values in them are different from defaults as that could break websites functionality. You have to run a command with a key to overwrite them. Please find more information "),a("router-link",{attrs:{to:"/cloudlinux_os_components/#configuring-global-php-ini-options-for-all-alt-php-versions"}},[e._v("here")])],1),e._v(" "),a("h2",{attrs:{id:"how-to-patch-php-fpm-binary-file"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#how-to-patch-php-fpm-binary-file"}},[e._v("#")]),e._v(" How to patch PHP-FPM binary file?")]),e._v(" "),a("p",[e._v('This article describes how to apply our patches for PHP-FPM. First of all, you should download "PHP" archive (Note that this link will be different for each PHP version). In this case we will use PHP 5.4.45 version:')]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("wget http://nl3.php.net/get/php-5.4.45.tar.gz/from/this/mirror\n")])])])]),e._v(" "),a("p",[e._v("When download completed, rename, unpack and change its directory:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("mv mirror.1 php-5.4.45.tar.gz\ntar -zxvf php-5.4.45.tar.gz\ncd php-5.4.45/\n")])])])]),e._v(" "),a("p",[e._v("Then download the following package which contains all the necessary files to apply patches:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("wget http://repo.cloudlinux.com/cloudlinux/sources/da/cl-apache-patches.tar.gz\ntar -zxvf cl-apache-patches.tar.gz\n")])])])]),e._v(" "),a("p",[e._v("Before applying CloudLinux patches, please make sure that "),a("code",[e._v("liblve-devel")]),e._v(" has already been installed into the system:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("rpm -qa | grep liblve-devel\n")])])])]),e._v(" "),a("p",[a("code",[e._v("liblve-devel-1.3-1.10.el6.cloudlinux.x86_64")])]),e._v(" "),a("p",[e._v("If not, please run:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("yum install liblve-devel -y\n")])])])]),e._v(" "),a("p",[e._v("On CloudLinux OS 7 server - install "),a("code",[e._v("systemd-devel")]),e._v(":")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("yum install systemd-devel\n")])])])]),e._v(" "),a("p",[e._v("Apply patch:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("patch -p1 < fpm-lve-php5.4.patch\n")])])])]),e._v(" "),a("p",[e._v("If everything looks fine, please run the following commands to build it (CloudLinux OS 6):")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("autoconf \n./configure --enable-fpm\nmake\n")])])])]),e._v(" "),a("p",[e._v("CloudLinux OS 7 requires "),a("code",[e._v("systemd")]),e._v(" support:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("autoconf\n./configure --enable-fpm --with-fpm-systemd\nmake\n")])])])]),e._v(" "),a("p",[e._v("When rebuild completed, find a new PHP-FPM binary file:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("find . | grep php-fpm\n")])])])]),e._v(" "),a("p",[a("code",[e._v("./sapi/fpm/php-fpm")])]),e._v(" "),a("p",[e._v("To make sure that it contains all our patches run:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('strings ./sapi/fpm/php-fpm | egrep "jail|lve"\n')])])])]),e._v(" "),a("p",[a("code",[e._v("liblve.so.0 lve_exit init_lve lve_jail_uid destroy_lve lve_enter_flags fpm_lve_enter fpm_lve_leave")])]),e._v(" "),a("p",[e._v("If everything looks fine, please rename the current PHP-FPM file:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("which php-fpm\n")])])])]),e._v(" "),a("p",[a("code",[e._v("/usr/local/sbin/php-fpm")])]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("mv /usr/local/sbin/php-fpm /usr/local/sbin/php-fpm.old\n")])])])]),e._v(" "),a("p",[e._v("And copy the new one:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("cp /root/php-5.4.45/sapi/fpm/php-fpm /usr/local/sbin/\n")])])])]),e._v(" "),a("p",[e._v("Then you need to restart PHP-FPM service to apply changes and check PHP info page.")]),e._v(" "),a("h2",{attrs:{id:"different-php-versions-per-directories-using-suphp"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#different-php-versions-per-directories-using-suphp"}},[e._v("#")]),e._v(" Different PHP versions per directories using suPHP")]),e._v(" "),a("p",[e._v("We had few requests to support different PHP versions per directory. While this is not available using PHP Selector UI, it is fairly simple to do manually. The important requirement is that PHP must be set to run in suPHP mode. Tested with cPanel, however it will work on any other server.")]),e._v(" "),a("p",[e._v("Here is quick how-to:")]),e._v(" "),a("ol",[a("li",[e._v("Configure handlers for different versions and point them to already provided "),a("code",[e._v("php-cgi")]),e._v(" binaries, they all are visible from inside CageFS.")])]),e._v(" "),a("p",[e._v("Add the following section to "),a("code",[e._v("handlers")]),e._v(" section in "),a("em",[e._v("/opt/suphp/etc/suphp.conf")]),e._v(":")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('application/x-httpd-php52="php:/opt/alt/php52/usr/bin/php-cgi"\napplication/x-httpd-php53="php:/opt/alt/php53/usr/bin/php-cgi"\napplication/x-httpd-php54="php:/opt/alt/php54/usr/bin/php-cgi"\napplication/x-httpd-php55="php:/opt/alt/php55/usr/bin/php-cgi"\napplication/x-httpd-php56="php:/opt/alt/php56/usr/bin/php-cgi"\napplication/x-httpd-php70="php:/opt/alt/php70/usr/bin/php-cgi"\napplication/x-httpd-php71="php:/opt/alt/php71/usr/bin/php-cgi"\n')])])])]),e._v(" "),a("p",[e._v("for EasyApache 4 you need to add handlers into "),a("em",[e._v("/etc/suphp.conf")]),e._v(" file.")]),e._v(" "),a("ol",{attrs:{start:"2"}},[a("li",[e._v("Add suPHP handlers for each version, this should be done before other configs. On cPanel server, edit "),a("em",[e._v("/usr/local/apache/conf/includes/pre_virtualhost_global.conf")]),e._v(" and add the following section:")])]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("<IfModule mod_suphp.c>\n<Directory />\nsuPHP_AddHandler application/x-httpd-php52\nsuPHP_AddHandler application/x-httpd-php53\nsuPHP_AddHandler application/x-httpd-php54\nsuPHP_AddHandler application/x-httpd-php55\nsuPHP_AddHandler application/x-httpd-php56\nsuPHP_AddHandler application/x-httpd-php70\nsuPHP_AddHandler application/x-httpd-php71\n</Directory>\n</IfModule>\n")])])])]),e._v(" "),a("ol",{attrs:{start:"3"}},[a("li",[e._v("Restart Apache:")])]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("# service httpd restart\n")])])])]),e._v(" "),a("p",[e._v("That’s it, now Apache understands what binary should be used for different mime types. To use the desired version in a particular directory, just add a line to .htaccess in that directory (or create .htaccess file with that line, if it is not there). For example, for php5.4, add the following line:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("AddHandler application/x-httpd-php54 .php .php5\n")])])])]),e._v(" "),a("p",[e._v("Subdirectories will use the same PHP version as the parent unless you override it with another .htaccess entry in that subdirectory. To match PHP extensions selection with extensions selected by an end user for that PHP version in PHP Selector you have to follow "),a("router-link",{attrs:{to:"/cloudlinux_os_components/#php-extensions"}},[e._v("this article")]),e._v(". This is not an officially supported way to run multiple PHP per account, but it is a safe hack that will work for anyone using suPHP.")],1),e._v(" "),a("div",{staticClass:"tip custom-block"},[a("p",{staticClass:"custom-block-title"},[e._v("Note")]),a("p",[e._v("There is one little trick that can be confusing. It applies only if you have PHP Selector enabled and you have non-native version selected there for a user. In that case, if the version that you assign through .htaccess is the same as ea-php version selected as system default version in WHM -> MultiPHP Manager -> System Default version, that version will not be applies, the version that you'll actually get will be the same as selected in PHP Selector.")])]),a("h2",{attrs:{id:"integrating-ldap-users-with-cagefs"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#integrating-ldap-users-with-cagefs"}},[e._v("#")]),e._v(" Integrating LDAP users with CageFS")]),e._v(" "),a("p",[e._v("When using LDAP to store user data it requires additional configuration to work properly with CageFS. By default CageFS does not see LDAP user, like this:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("# id adam\nuid=16859(adam) gid=100(users) groups=100(users)\n# cagefsctl --enable adam\nError: user adam does not exist\n")])])])]),e._v(" "),a("p",[e._v("The problem is that in LDAP "),a("code",[e._v("pwd.getpwall()")]),e._v(" function doesn't work by default:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("# python -c 'import pwd; print pwd.getpwall()' | grep adam\n#\n# python -c 'import pwd; print pwd.getpwnam(\"adam\")'\npwd.struct_passwd(pw_name='adam', pw_passwd='*', pw_uid=16859, pw_gid=100, pw_gecos='adam', pw_dir='/home/adam', pw_shell='/bin/bash')\n")])])])]),e._v(" "),a("p",[e._v("To fix it you should set "),a("code",[e._v("enumerate=true")]),e._v(" in "),a("em",[e._v("sssd.conf")]),e._v(" file:")]),e._v(" "),a("p",[a("code",[e._v("enumerate (bool) Determines if the domain can be enumerated. This parameter can have one of the following values: TRUE = Users and groups are enumerated FALSE = No enumerations for this domain Default: FALSE")])]),e._v(" "),a("h2",{attrs:{id:"how-to-activate-inode-usage-displaying-in-cpanel"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#how-to-activate-inode-usage-displaying-in-cpanel"}},[e._v("#")]),e._v(" How to activate inode usage displaying in cPanel?")]),e._v(" "),a("div",{staticClass:"warning custom-block"},[a("p",{staticClass:"custom-block-title"},[e._v("WARNING")]),a("p",[e._v("cPanel only")])]),a("p",[e._v("LVE Manager inodes Limits extension allows you to set inodes limits for your customers. An inode is a data structure on a file system used to keep information about a file or a folder. The number of inodes indicates the number of files and folders an account has. inodes limits work on the level of system disk quota.")]),e._v(" "),a("p",[e._v("To display inode usage in user's panel the following should correspond:")]),e._v(" "),a("ol",[a("li",[a("p",[e._v("System quotas enabled and working.")])]),e._v(" "),a("li",[a("p",[e._v("cPanel inode count is turned off in "),a("em",[e._v("WHM > Tweak settings")]),e._v(".")])]),e._v(" "),a("li",[a("p",[a("code",[e._v("Show end-user inodes usage")]),e._v(" option is enabled in "),a("em",[e._v("WHM > CloudLinux LVE Manager > Options")]),e._v(".")])])]),e._v(" "),a("h2",{attrs:{id:"how-to-fix-cpanel-mailing-list-archiving-functionality-when-link-traversal-protection-is-enabled"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#how-to-fix-cpanel-mailing-list-archiving-functionality-when-link-traversal-protection-is-enabled"}},[e._v("#")]),e._v(" How to fix cPanel mailing list archiving functionality when link traversal protection is enabled?")]),e._v(" "),a("p",[e._v("If "),a("router-link",{attrs:{to:"/cloudlinux_os_kernel/#link-traversal-protection"}},[e._v("link traversal protection")]),e._v(" is enabled on cPanel server, the mailman archiving feature stops working as it creates some internal symlinks in "),a("em",[e._v("/usr/local/cpanel/3rdparty/mailman/archives/private/listname_domain.com/")]),e._v(". You may notice the following error in "),a("em",[e._v("/usr/local/cpanel/3rdparty/mailman/logs/error")]),e._v(" file:")],1),e._v(" "),a("p",[a("code",[e._v('Oct 19 23:49:21 2015 (532564) Uncaught runner exception: [Errno 2] No such file or directory Oct 19 23:49:21 2015 (532564) Traceback (most recent call last): File "/usr/local/cpanel/3rdparty/mailman/Mailman/Queue/Runner.py", line 119, in _oneloop self._onefile(msg, msgdata) File "/usr/local/cpanel/3rdparty/mailman/Mailman/Queue/Runner.py", line 190, in _onefile keepqueued = self._dispose(mlist, msg, msgdata) File "/usr/local/cpanel/3rdparty/mailman/Mailman/Queue/ArchRunner.py", line 73, in _dispose mlist.ArchiveMail(msg) File "/usr/local/cpanel/3rdparty/mailman/Mailman/Archiver/Archiver.py", line 216, in ArchiveMail h.processUnixMailbox(f) File "/usr/local/cpanel/3rdparty/mailman/Mailman/Archiver/pipermail.py", line 586, in processUnixMailbox self.add_article(a) File "/usr/local/cpanel/3rdparty/mailman/Mailman/Archiver/pipermail.py", line 623, in add_article self.new_archive(arch, archivedir) File "/usr/local/cpanel/3rdparty/mailman/Mailman/Archiver/pipermail.py", line 608, in new_archive self.open_new_archive(archive, archivedir) File "/usr/local/cpanel/3rdparty/mailman/Mailman/Archiver/HyperArch.py", line 1047, in open_new_archive os.symlink(self.DEFAULTINDEX+\'.html\',index_html) OSError: [Errno 2] No such file or directory')])]),e._v(" "),a("p",[e._v("To fix the issue you should add "),a("code",[e._v("mailman")]),e._v(" user to "),a("code",[e._v("linksafe")]),e._v(" group, so it could manage symlinks as needed:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("usermod -a -G linksafe mailman\n")])])])]),e._v(" "),a("h2",{attrs:{id:"how-to-mount-a-directory-inside-cagefs-for-particular-users-only"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#how-to-mount-a-directory-inside-cagefs-for-particular-users-only"}},[e._v("#")]),e._v(" How to mount a directory inside CageFS for particular users only?")]),e._v(" "),a("p",[e._v("The easiest way is to use "),a("router-link",{attrs:{to:"/cloudlinux_os_components/#split-by-username"}},[e._v("split")]),e._v(" approach. But it will work only if you add a username inside the directory you want to share:")],1),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('$ mkdir /sharedir\n$ ln -s /share_dir /sharedir/username\n$ ln -s /sharedir/username /usr/share/cagefs-skeleton/share_dir\n$ echo "%/sharedir" >> /etc/cagefs/cagefs.mp\n$ cagefsctl --remount-all\n')])])])]),e._v(" "),a("p",[e._v("Please note that first you create empty "),a("code",[e._v("sharedir")]),e._v(" directory, and the actual content is located in "),a("code",[e._v("share_dir")])]),e._v(" "),a("h2",{attrs:{id:"how-to-add-own-comments-to-php-versions-in-php-selector"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#how-to-add-own-comments-to-php-versions-in-php-selector"}},[e._v("#")]),e._v(" How to add own comments to PHP versions in PHP Selector?")]),e._v(" "),a("p",[e._v("CloudLInux OS provides an opportunity to add custom comments to PHP versions, chosen with PHP Selector by users. Usually, they are used to notify users about outdated or recommended versions.")]),e._v(" "),a("p",[e._v("Upon forming a list of available versions "),a("code",[e._v("selectorctl")]),e._v(" tool is looking for "),a("em",[e._v("/opt/alt/phpXX/name_modifier")]),e._v(" file to append it as a comment to a version.")]),e._v(" "),a("p",[e._v("To add your own comments - create a file for desired PHP version and write a text inside:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("$ vi /opt/alt/php54/name_modifier\n")])])])]),e._v(" "),a("p",[e._v("Do the same for other PHP versions. The changes are applied instantly. Make sure to add just a few words not to break dropdown list. The text will be shown in brackets in the LVEmanager UI:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("$ selectorctl -i php --summary\n")])])]),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("4.4 e - Totally unsupported version  \n5.1 - - Totally unsupported version  \n5.2 - - Totally unsupported version  \n5.3 e - Outdated version  \n5.4 e - Outdated version  \n5.5 e - Safe to use  \n5.6 e d Supported version  \n7.0 e - Recommended version  \nnative e -\n")])])])]),e._v(" "),a("h2",{attrs:{id:"running-cloudlinux-os-7-with-ovh-server"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#running-cloudlinux-os-7-with-ovh-server"}},[e._v("#")]),e._v(" Running CloudLinux OS 7 with OVH server")]),e._v(" "),a("p",[e._v("Servers from OVH can require additional configurations after converting to CloudLinux OS 7. Also, use this KB article if you are getting the following warning with cldeploy:")]),e._v(" "),a("p",[a("code",[e._v("Invalid /etc/mdadm.conf file detected")])]),e._v(" "),a("p",[e._v("Complete checklist to successfully run CloudLinux OS 7 kernel.")]),e._v(" "),a("ol",[a("li",[e._v("Check for proper UUIDs and correct "),a("em",[e._v("mdadm.conf")]),e._v(" file formatting")])]),e._v(" "),a("p",[e._v("Obtain UUIDs for RAID devices with "),a("code",[e._v("mdadm")]),e._v(" utility:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("$ mdadm --detail --scan\n")])])]),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("ARRAY /dev/md2 metadata=0.90 UUID=70160d35:1398d208:a4d2adc2:26fd5302\nARRAY /dev/md3 metadata=0.90 UUID=5ccb84a1:516cc4d3:a4d2adc2:26fd5302\nARRAY /dev/md5 metadata=0.90 UUID=ae269fab:c345c72d:a4d2adc2:26fd5302\n")])])])]),e._v(" "),a("p",[e._v("Modify "),a("em",[e._v("/etc/mdadm.conf")]),e._v(" file to make it look like in the example below. Note that AUTO command is required.")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("$ vi /etc/mdadm.conf\n")])])]),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("MAILADDR root\nAUTO +imsm +1.x -all\nARRAY /dev/md2 level=raid1 num-devices=2 UUID=70160d35:1398d208:a4d2adc2:26fd5302\nARRAY /dev/md3 level=raid1 num-devices=2 UUID=5ccb84a1:516cc4d3:a4d2adc2:26fd5302\nARRAY /dev/md5 level=raid1 num-devices=2 UUID=ae269fab:c345c72d:a4d2adc2:26fd5302\n")])])])]),e._v(" "),a("div",{staticClass:"tip custom-block"},[a("p",{staticClass:"custom-block-title"},[e._v("Note")]),a("p",[e._v("It is only an example, you need to use ARRAY entries from output of mdadm --detail --scan command.")])]),a("ol",{attrs:{start:"2"}},[a("li",[e._v("Check for the proper command line in "),a("em",[e._v("grub.cfg")]),e._v(" file")])]),e._v(" "),a("p",[e._v("Check if "),a("code",[e._v("net.ifnames=0 rd.auto=1")]),e._v(" are present in "),a("em",[e._v("grub.cfg")]),e._v(" file:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('$ grep "net.ifnames=0 rd.auto=1" /boot/grub2/grub.cfg\n')])])])]),e._v(" "),a("p",[e._v("If no output returned, you have to edit default grub:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("$ vi /etc/default/grub\n")])])])]),e._v(" "),a("p",[e._v("And add those options to "),a("code",[e._v("cmdline")]),e._v(":")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('GRUB_CMDLINE_LINUX="net.ifnames=0 rd.auto=1"\n')])])])]),e._v(" "),a("p",[e._v("Rebuild "),a("em",[e._v("grub.cfg")]),e._v(":")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("$ grub2-mkconfig -o /boot/grub2/grub.cfg\n")])])])]),e._v(" "),a("ol",{attrs:{start:"3"}},[a("li",[e._v("Check if RAID drivers added")])]),e._v(" "),a("p",[e._v("Make sure "),a("em",[e._v("raid.conf")]),e._v(" contains all the required options. In most cases "),a("code",[e._v("$add_drivers")]),e._v(" is missing:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("$ vi /etc/dracut.conf.d/raid.conf\n")])])])]),e._v(" "),a("p",[e._v("It should look as follows:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('add_drivers="$add_drivers raid1 raid0"\n')])])])]),e._v(" "),a("p",[e._v("Rebuild "),a("em",[e._v("initramfs")]),e._v(" file, change kernel version in the example above to the latest one installed on your server:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("$ dracut -f /boot/initramfs-3.10.0-427.18.2.lve1.4.24.el7.x86_64.img 3.10.0-427.18.2.lve1.4.24.el7.x86_64\n")])])])]),e._v(" "),a("ol",{attrs:{start:"3"}},[a("li",[e._v("Check if RAID drivers added")])]),e._v(" "),a("p",[e._v("Make sure "),a("em",[e._v("raid.conf")]),e._v(" contains all the required options. In most cases "),a("code",[e._v("$add_drivers")]),e._v(" is missing:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("$ vi /etc/dracut.conf.d/raid.conf\n")])])])]),e._v(" "),a("p",[e._v("It should look as follows:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('add_drivers="$add_drivers raid1 raid0"\n')])])])]),e._v(" "),a("p",[e._v("Rebuild "),a("em",[e._v("initramfs")]),e._v(" file, change kernel version in the example above to the latest one installed on your server:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("$ dracut -f /boot/initramfs-3.10.0-427.18.2.lve1.4.24.el7.x86_64.img 3.10.0-427.18.2.lve1.4.24.el7.x86_64\n")])])])]),e._v(" "),a("ol",{attrs:{start:"4"}},[a("li",[e._v("Optional, switch to UUIDs in "),a("em",[e._v("/etc/fstab")]),e._v("\nObtain block IDs for "),a("code",[e._v("md")]),e._v(" devices:")])]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("$ blkid | grep md\n")])])]),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('/dev/md2: LABEL="/boot" UUID="d154fcbd-7802-47a6-8d49-4be2688eee73" TYPE="ext4"\n/dev/md3: LABEL="/tmp" UUID="ea5e8258-7be3-42ea-984f-3e1fc83f35d1" TYPE="ext4"\n/dev/md5: LABEL="/" UUID="7936780f-36cc-4c13-a59e-3e599ba847d2" TYPE="ext4"\n')])])])]),e._v(" "),a("p",[e._v("Open "),a("em",[e._v("/etc/fstab")]),e._v(" and replace "),a("code",[e._v("md*")]),e._v(" with UUIDs:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("$ vi /etc/fstab\n")])])]),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("# <file system> <mount point> <type> <options> <dump> <pass>\nUUID=7936780f-36cc-4c13-a59e-3e599ba847d2 / ext4 errors=remount-ro,usrquota 0 1\nUUID=d154fcbd-7802-47a6-8d49-4be2688eee73 /boot ext4 errors=remount-ro 0 1\nUUID=ea5e8258-7be3-42ea-984f-3e1fc83f35d1 /tmp ext4 defaults 1 2\n\nproc /proc proc defaults 0 0\nsysfs /sys sysfs defaults 0 0\ntmpfs /dev/shm tmpfs defaults 0 0\ndevpts /dev/pts devpts defaults 0 0\n")])])])]),e._v(" "),a("ol",{attrs:{start:"5"}},[a("li",[e._v("Check if CloudLinux OS kernel is going to be booted with grub")])]),e._v(" "),a("p",[e._v("If needed - choose CloudLinux OS kernel. Please follow "),a("a",{attrs:{href:"#how-do-I-choose-which-kernel-to-boot-on-CloudLinux-os-7"}},[e._v("this article ")]),e._v(". If you experience any issues during server boot with CloudLinux OS 7 kernel - reboot the server into rescue console and create a ticket at "),a("a",{attrs:{href:"https://cloudlinux.zendesk.com/hc/en-us/requests/new",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://cloudlinux.zendesk.com/hc/en-us/requests/new"),a("OutboundLink")],1),e._v(".")]),e._v(" "),a("h2",{attrs:{id:"managing-mysql-packages-on-cpanel-server-for-mysql-governor-installed"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#managing-mysql-packages-on-cpanel-server-for-mysql-governor-installed"}},[e._v("#")]),e._v(" Managing MySQL packages on cPanel server for MySQL Governor installed")]),e._v(" "),a("p",[e._v("If you have MySQL Governor installed, all MySQL upgrades and version changes should be changed using MySQL Governor tools, e.g. "),a("router-link",{attrs:{to:"/cloudlinux_os_components/#change-mysql-version"}},[e._v("https://docs.cloudlinux.com/cloudlinux_os_components/#change-mysql-version")])],1),e._v(" "),a("p",[e._v("On cPanel servers, when "),a("code",[e._v("mysqlgovernor.py --install")]),e._v(" is executed, we create "),a("em",[e._v("/var/cpanel/rpm.versions.d/cloudlinux.versions")])]),e._v(" "),a("p",[e._v("The file is required to disable management of MySQL related packages provided by cPanel and allow MySQL Governor to manage them.")]),e._v(" "),a("p",[a("strong",[e._v("Note")]),e._v(". When you have an own definition for MySQL* in "),a("em",[e._v("local.versions")]),e._v(" or "),a("em",[e._v("cloudlinux.version")]),e._v(" file does not exist you have to run the following commands to ensure cPanel is no longer managing MySQL:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("/usr/local/cpanel/scripts/update_local_rpm_versions --edit target_settings.MySQL50 unmanaged\n/usr/local/cpanel/scripts/update_local_rpm_versions --edit target_settings.MySQL51 unmanaged\n/usr/local/cpanel/scripts/update_local_rpm_versions --edit target_settings.MySQL55 unmanaged\n/usr/local/cpanel/scripts/update_local_rpm_versions --edit target_settings.MySQL56 unmanaged\n/usr/local/cpanel/scripts/update_local_rpm_versions --edit target_settings.MariaDB100 unmanaged\n")])])])]),e._v(" "),a("p",[e._v("If you want to restore the original cPanel-provided MySQL packages after removing MySQL Governor, please run the following commands:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("/usr/local/cpanel/scripts/update_local_rpm_versions --del target_settings.MySQL50\n/usr/local/cpanel/scripts/update_local_rpm_versions --del target_settings.MySQL51\n/usr/local/cpanel/scripts/update_local_rpm_versions --del target_settings.MySQL55\n/usr/local/cpanel/scripts/update_local_rpm_versions --del target_settings.MySQL56\n/usr/local/cpanel/scripts/update_local_rpm_versions --del target_settings.MariaDB100\n")])])])]),e._v(" "),a("p",[e._v("and then run:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("/scripts/upcp --force\n")])])])]),e._v(" "),a("h2",{attrs:{id:"how-to-run-redmine-with-ruby-selector"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#how-to-run-redmine-with-ruby-selector"}},[e._v("#")]),e._v(" How to run Redmine with Ruby Selector?")]),e._v(" "),a("p",[a("strong",[e._v("Preface")])]),e._v(" "),a("p",[e._v("Redmine is a flexible project management web application written using Ruby on Rails framework. It is easy to install it using CloudLinux [Ruby Selector](https://www.cloudlinux.com/ruby-selector]. Follow "),a("router-link",{attrs:{to:"/cloudlinux_os_components/#installation-and-update-6"}},[e._v("this guide")]),e._v(" to install Ruby Selector. It works with CageFS, so make sure to enable it for the account. Redmine version described in installation instructions is different from Redmine version used. The example given describes the process for version 3.3.1. For other versions please refer to "),a("em",[e._v("doc/INSTALL")]),e._v(" file provided with downloaded Redmine archive or to the official "),a("a",{attrs:{href:"http://www.redmine.org/projects/redmine/wiki/RedmineInstall",target:"_blank",rel:"noopener noreferrer"}},[e._v("Installation Guide"),a("OutboundLink")],1),e._v(".")],1),e._v(" "),a("p",[a("strong",[e._v("Setting up a working environment")])]),e._v(" "),a("ol",[a("li",[e._v("In cPanel (as a user) create MySQL database, create MySQL user and Add user to Database granting all privileges.")])]),e._v(" "),a("p",[a("img",{attrs:{src:"/images/mceclip0.png",alt:"create DB"}})]),e._v(" "),a("p",[a("img",{attrs:{src:"/images/mceclip1.png",alt:"add user"}})]),e._v(" "),a("p",[a("img",{attrs:{src:"/images/mceclip2.png",alt:"add privileges"}})]),e._v(" "),a("ol",{attrs:{start:"2"}},[a("li",[e._v("Create a new application with 'Setup Ruby Application' menu, use Ruby version 2.3. Domain root or any subdirectory can be used.")])]),e._v(" "),a("p",[a("img",{attrs:{src:"/images/mceclip3.png",alt:"setup Ruby app"}})]),e._v(" "),a("ol",{attrs:{start:"3"}},[a("li",[e._v("("),a("strong",[e._v("if you'd like to use GUI")]),e._v(") After the application created, add the following modules with the proper version for each.")])]),e._v(" "),a("p",[a("code",[e._v("bundle, bundler#1.9.0, rails#4.2.7.1, bigdecimal#1.4.4, rake#12.3.2, mysql2#0.3.21")])]),e._v(" "),a("p",[a("img",{attrs:{src:"/images/mceclip4.png",alt:"add GUI modules"}})]),e._v(" "),a("p",[e._v("Click "),a("em",[e._v("Update")]),e._v(". It will take about 2 minutes to have them and dependent modules installed.")]),e._v(" "),a("p",[e._v("("),a("strong",[e._v("if you'd like to use CLI")]),e._v(") Log in as a cPanel user ("),a("code",[e._v("redmine")]),e._v(" in this example):")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("su -l -s /bin/bash redmine\nselectorctl --interpreter=ruby --version 2.3 --user redmine --create-webapp redmine /\n")])])])]),e._v(" "),a("p",[e._v("This will create a web app in "),a("em",[e._v("document_root/redmine")]),e._v(" (example : "),a("em",[e._v("/home/redmine/redmine")]),e._v(") under the primary domain URI (Example: http://redmine.com/). Next, you'll need to install extensions:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("selectorctl --interpreter=ruby --enable-user-extensions=bundle,bundler#1.9.0,rails#4.2.7.1,bigdecimal#1.4.4,rake#12.3.2,mysql2#0.3.21 redmine\nTITLE:bigdecimal#1.4.4\nSTATUS:OK\nTITLE:bundle\nSTATUS:OK\nTITLE:bundler#1.9.0\nSTATUS:OK\nTITLE:rails#4.2.7.1\nSTATUS:OK\nTITLE:rake#12.3.2\nSTATUS:OK\n")])])])]),e._v(" "),a("p",[e._v("This will enable all necessary modules required by redmine (here "),a("em",[e._v("redmine")]),e._v(" is your app folder)")]),e._v(" "),a("div",{staticClass:"warning custom-block"},[a("p",{staticClass:"custom-block-title"},[e._v("IMPORTANT")]),a("p",[e._v("Rails gem will update bundler to 2.0.1 version, which is not compatible with the current installation, so it is important to remove this version and leave 1.9.0 in place.")])]),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("selectorctl --interpreter=ruby --disable-user-extensions=bundler#2.0.1 redmine\n")])])])]),e._v(" "),a("div",{staticClass:"tip custom-block"},[a("p",{staticClass:"custom-block-title"},[e._v("Note")]),a("p",[e._v("In case mysql2 installation results in error, install it as root:")])]),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("[root@192-168-245-55 redmine]# source /home/redmine/rubyvenv/redmine/2.3/bin/activate\n(redmine:2.4)[root@192-168-245-55 redmine]# gem install mysql2 -v 0.3.21\nBuilding native extensions.  This could take a while...\nSuccessfully installed mysql2-0.3.21\nParsing documentation for mysql2-0.3.21\nInstalling ri documentation for mysql2-0.3.21\nDone installing documentation for mysql2 after 0 seconds\n1 gem installed\n")])])])]),e._v(" "),a("ol",{attrs:{start:"4"}},[a("li",[e._v("Install "),a("code",[e._v("ImageMagick-devel")]),e._v(" for "),a("code",[e._v("rmagick")]),e._v(" gem:")])]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("$ yum install ImageMagick-devel\n")])])])]),e._v(" "),a("p",[a("strong",[e._v("Deploying Redmine")])]),e._v(" "),a("ol",[a("li",[e._v("Log in to the server as a user (ssh or su -):")])]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("$ su -l -s /bin/bash redmine\n")])])])]),e._v(" "),a("ol",{attrs:{start:"2"}},[a("li",[e._v("Download the latest Redmine:")])]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("$ wget http://www.redmine.org/releases/redmine-3.3.1.tar.gz\n")])])])]),e._v(" "),a("ol",{attrs:{start:"3"}},[a("li",[e._v("Unpack it and move to the chosen application directory ("),a("em",[e._v("redmine")]),e._v(" in this example):")])]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("$ tar xfz redmine-3.3.1.tar.gz\n$ cp -rp redmine-3.3.1/* redmine/\n")])])])]),e._v(" "),a("ol",{attrs:{start:"4"}},[a("li",[e._v("Fill out database credentials that we have created with cPanel:")])]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("$ cd redmine\n$ cp config/database.yml.example config/database.yml\n$ vi config/database.yml\n")])])]),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('production:\n adapter: mysql2\n database: redtest_db\n host: localhost\n username: redtest_user\n password: "my1passwd"\n encoding: utf8\n')])])])]),e._v(" "),a("ol",{attrs:{start:"5"}},[a("li",[e._v("Activate the Ruby environment:")])]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("$ source ~/rubyvenv/redmine/2.3/bin/activate\n")])])])]),e._v(" "),a("ol",{attrs:{start:"6"}},[a("li",[e._v("Make sure that you are in the app directory. Add the "),a("code",[e._v("bigdecimal")]),e._v(" gem into "),a("em",[e._v("Gemfile")]),e._v(":")])]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("$ cd redmine\n$ pwd\n/home/redmine/redmine\nnano Gemfile\n")])])])]),e._v(" "),a("p",[e._v("Install the modules required by Redmine:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("$ bundle install --without development test\n")])])])]),e._v(" "),a("p",[e._v("Redmine stores session data in cookies by default, which requires a secret token to be generated. Do it and create database structure:")]),e._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('$ bundle exec rake generate_secret_token\n$ bundle exec rake db:migrate RAILS_ENV="production"\n')])])])]),e._v(" "),a("p",[a("strong",[e._v("First login")])]),e._v(" "),a("ol",[a("li",[e._v("Open Redmine location URL in the browser. Use the default administrator account to log in: login: "),a("strong",[e._v("admin")]),e._v(" password: "),a("strong",[e._v("admin")])]),e._v(" "),a("li",[e._v("Change your password to a new one with the proposed form.")]),e._v(" "),a("li",[e._v("Go to "),a("em",[e._v("Administration")]),e._v(" on the top, choose a preferred language and load the default configuration.")])]),e._v(" "),a("div",{staticClass:"tip custom-block"},[a("p",{staticClass:"custom-block-title"},[e._v("Note")]),a("p",[e._v("After adding some other modules to an Application with cPanel interface you may need to restart the application, which can be done on the same Ruby Selector page.")])])])},[],!1,null,null,null);t.default=r.exports}}]);